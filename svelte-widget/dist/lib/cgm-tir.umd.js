(function(Ct,lt){typeof exports=="object"&&typeof module<"u"?lt(exports):typeof define=="function"&&define.amd?define(["exports"],lt):(Ct=typeof globalThis<"u"?globalThis:Ct||self,lt(Ct.CgmTir={}))})(this,function(Ct){"use strict";var qc=Object.defineProperty;var $c=(Ct,lt,Gt)=>lt in Ct?qc(Ct,lt,{enumerable:!0,configurable:!0,writable:!0,value:Gt}):Ct[lt]=Gt;var ir=(Ct,lt,Gt)=>$c(Ct,typeof lt!="symbol"?lt+"":lt,Gt);function lt(){}function Gt(t){return t()}function or(){return Object.create(null)}function we(t){t.forEach(Gt)}function ar(t){return typeof t=="function"}function ve(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function $i(t){return Object.keys(t).length===0}function At(t){return t??""}function T(t,e){t.appendChild(e)}function _e(t,e,n){t.insertBefore(e,n||null)}function ie(t){t.parentNode&&t.parentNode.removeChild(t)}function $(t){return document.createElement(t)}function sr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function dt(t){return document.createTextNode(t)}function yt(){return dt(" ")}function Pt(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function W(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Bi(t){return Array.from(t.childNodes)}function Ht(t,e){e=""+e,t.data!==e&&(t.data=e)}function q(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Oi(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let xe;function be(t){xe=t}function ur(){if(!xe)throw new Error("Function called outside component initialization");return xe}function Me(t){ur().$$.on_mount.push(t)}function Xi(){const t=ur();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=Oi(e,n,{cancelable:r});return i.slice().forEach(s=>{s.call(t,o)}),!o.defaultPrevented}return!0}}const oe=[],ae=[];let se=[];const lr=[],Vi=Promise.resolve();let vn=!1;function Gi(){vn||(vn=!0,Vi.then(cr))}function _n(t){se.push(t)}const xn=new Set;let ue=0;function cr(){if(ue!==0)return;const t=xe;do{try{for(;ue<oe.length;){const e=oe[ue];ue++,be(e),Zi(e.$$)}}catch(e){throw oe.length=0,ue=0,e}for(be(null),oe.length=0,ue=0;ae.length;)ae.pop()();for(let e=0;e<se.length;e+=1){const n=se[e];xn.has(n)||(xn.add(n),n())}se.length=0}while(oe.length);for(;lr.length;)lr.pop()();vn=!1,xn.clear(),be(t)}function Zi(t){if(t.fragment!==null){t.update(),we(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_n)}}function Ji(t){const e=[],n=[];se.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),se=e}const Qi=new Set;function Ki(t,e){t&&t.i&&(Qi.delete(t),t.i(e))}function ji(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),_n(()=>{const o=t.$$.on_mount.map(Gt).filter(ar);t.$$.on_destroy?t.$$.on_destroy.push(...o):we(o),t.$$.on_mount=[]}),i.forEach(_n)}function to(t,e){const n=t.$$;n.fragment!==null&&(Ji(n.after_update),we(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function eo(t,e){t.$$.dirty[0]===-1&&(oe.push(t),Gi(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Te(t,e,n,r,i,o,s=null,u=[-1]){const l=xe;be(t);const a=t.$$={fragment:null,ctx:[],props:o,update:lt,not_equal:i,bound:or(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:or(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};s&&s(a.root);let f=!1;if(a.ctx=n?n(t,e.props||{},(c,h,...g)=>{const w=g.length?g[0]:h;return a.ctx&&i(a.ctx[c],a.ctx[c]=w)&&(!a.skip_bound&&a.bound[c]&&a.bound[c](w),f&&eo(t,c)),h}):[],a.update(),f=!0,we(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const c=Bi(e.target);a.fragment&&a.fragment.l(c),c.forEach(ie)}else a.fragment&&a.fragment.c();e.intro&&Ki(t.$$.fragment),ji(t,e.target,e.anchor),cr()}be(l)}class Ce{constructor(){ir(this,"$$");ir(this,"$$set")}$destroy(){to(this,1),this.$destroy=lt}$on(e,n){if(!ar(n))return lt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!$i(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const no="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(no);function Ve(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ro(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fr(t){let e,n,r;t.length!==2?(e=Ve,n=(u,l)=>Ve(t(u),l),r=(u,l)=>t(u)-l):(e=t===Ve||t===ro?t:io,n=t,r=t);function i(u,l,a=0,f=u.length){if(a<f){if(e(l,l)!==0)return f;do{const c=a+f>>>1;n(u[c],l)<0?a=c+1:f=c}while(a<f)}return a}function o(u,l,a=0,f=u.length){if(a<f){if(e(l,l)!==0)return f;do{const c=a+f>>>1;n(u[c],l)<=0?a=c+1:f=c}while(a<f)}return a}function s(u,l,a=0,f=u.length){const c=i(u,l,a,f-1);return c>a&&r(u[c-1],l)>-r(u[c],l)?c-1:c}return{left:i,center:s,right:o}}function io(){return 0}function oo(t){return t===null?NaN:+t}const ao=fr(Ve).right;fr(oo).center;function so(t,e){let n=0,r,i=0,o=0;for(let s of t)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));if(n>1)return o/(n-1)}const uo=Math.sqrt(50),lo=Math.sqrt(10),co=Math.sqrt(2);function Ge(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=uo?10:o>=lo?5:o>=co?2:1;let u,l,a;return i<0?(a=Math.pow(10,-i)/s,u=Math.round(t*a),l=Math.round(e*a),u/a<t&&++u,l/a>e&&--l,a=-a):(a=Math.pow(10,i)*s,u=Math.round(t/a),l=Math.round(e/a),u*a<t&&++u,l*a>e&&--l),l<u&&.5<=n&&n<2?Ge(t,e,n*2):[u,l,a]}function fo(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,s]=r?Ge(e,t,n):Ge(t,e,n);if(!(o>=i))return[];const u=o-i+1,l=new Array(u);if(r)if(s<0)for(let a=0;a<u;++a)l[a]=(o-a)/-s;else for(let a=0;a<u;++a)l[a]=(o-a)*s;else if(s<0)for(let a=0;a<u;++a)l[a]=(i+a)/-s;else for(let a=0;a<u;++a)l[a]=(i+a)*s;return l}function bn(t,e,n){return e=+e,t=+t,n=+n,Ge(t,e,n)[2]}function ho(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?bn(e,t,n):bn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function go(t,e){let n=0,r=0;for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);if(n)return r/n}function Mn(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function mo(t){return t}var Tn=1,Cn=2,kn=3,ke=4,hr=1e-6;function po(t){return"translate("+t+",0)"}function yo(t){return"translate(0,"+t+")"}function wo(t){return e=>+t(e)}function vo(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function _o(){return!this.__axis}function gr(t,e){var n=[],r=null,i=null,o=6,s=6,u=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,a=t===Tn||t===ke?-1:1,f=t===ke||t===Cn?"x":"y",c=t===Tn||t===kn?po:yo;function h(g){var w=r??(e.ticks?e.ticks.apply(e,n):e.domain()),x=i??(e.tickFormat?e.tickFormat.apply(e,n):mo),N=Math.max(o,0)+u,R=e.range(),H=+R[0]+l,p=+R[R.length-1]+l,_=(e.bandwidth?vo:wo)(e.copy(),l),b=g.selection?g.selection():g,k=b.selectAll(".domain").data([null]),E=b.selectAll(".tick").data(w,e).order(),Z=E.exit(),X=E.enter().append("g").attr("class","tick"),L=E.select("line"),m=E.select("text");k=k.merge(k.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(X),L=L.merge(X.append("line").attr("stroke","currentColor").attr(f+"2",a*o)),m=m.merge(X.append("text").attr("fill","currentColor").attr(f,a*N).attr("dy",t===Tn?"0em":t===kn?"0.71em":"0.32em")),g!==b&&(k=k.transition(g),E=E.transition(g),L=L.transition(g),m=m.transition(g),Z=Z.transition(g).attr("opacity",hr).attr("transform",function(V){return isFinite(V=_(V))?c(V+l):this.getAttribute("transform")}),X.attr("opacity",hr).attr("transform",function(V){var A=this.parentNode.__axis;return c((A&&isFinite(A=A(V))?A:_(V))+l)})),Z.remove(),k.attr("d",t===ke||t===Cn?s?"M"+a*s+","+H+"H"+l+"V"+p+"H"+a*s:"M"+l+","+H+"V"+p:s?"M"+H+","+a*s+"V"+l+"H"+p+"V"+a*s:"M"+H+","+l+"H"+p),E.attr("opacity",1).attr("transform",function(V){return c(_(V)+l)}),L.attr(f+"2",a*o),m.attr(f,a*N).text(x),b.filter(_o).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Cn?"start":t===ke?"end":"middle"),b.each(function(){this.__axis=_})}return h.scale=function(g){return arguments.length?(e=g,h):e},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),h):n.slice()},h.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),h):r&&r.slice()},h.tickFormat=function(g){return arguments.length?(i=g,h):i},h.tickSize=function(g){return arguments.length?(o=s=+g,h):o},h.tickSizeInner=function(g){return arguments.length?(o=+g,h):o},h.tickSizeOuter=function(g){return arguments.length?(s=+g,h):s},h.tickPadding=function(g){return arguments.length?(u=+g,h):u},h.offset=function(g){return arguments.length?(l=+g,h):l},h}function xo(t){return gr(kn,t)}function bo(t){return gr(ke,t)}var Mo={value:()=>{}};function dr(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ze(n)}function Ze(t){this._=t}function To(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ze.prototype=dr.prototype={constructor:Ze,on:function(t,e){var n=this._,r=To(t+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(t=r[o]).type)&&(i=Co(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=mr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=mr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ze(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function Co(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function mr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Mo,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Dn="http://www.w3.org/1999/xhtml";const pr={svg:"http://www.w3.org/2000/svg",xhtml:Dn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Je(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),pr.hasOwnProperty(e)?{space:pr[e],local:t}:t}function ko(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Dn&&e.documentElement.namespaceURI===Dn?e.createElement(t):e.createElementNS(n,t)}}function Do(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function yr(t){var e=Je(t);return(e.local?Do:ko)(e)}function No(){}function Nn(t){return t==null?No:function(){return this.querySelector(t)}}function So(t){typeof t!="function"&&(t=Nn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=new Array(s),l,a,f=0;f<s;++f)(l=o[f])&&(a=t.call(l,l.__data__,f,o))&&("__data__"in l&&(a.__data__=l.__data__),u[f]=a);return new Nt(r,this._parents)}function Ao(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Fo(){return[]}function wr(t){return t==null?Fo:function(){return this.querySelectorAll(t)}}function Uo(t){return function(){return Ao(t.apply(this,arguments))}}function Eo(t){typeof t=="function"?t=Uo(t):t=wr(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],u=s.length,l,a=0;a<u;++a)(l=s[a])&&(r.push(t.call(l,l.__data__,a,s)),i.push(l));return new Nt(r,i)}function vr(t){return function(){return this.matches(t)}}function _r(t){return function(e){return e.matches(t)}}var Ro=Array.prototype.find;function Yo(t){return function(){return Ro.call(this.children,t)}}function Lo(){return this.firstElementChild}function Po(t){return this.select(t==null?Lo:Yo(typeof t=="function"?t:_r(t)))}var Ho=Array.prototype.filter;function Io(){return Array.from(this.children)}function zo(t){return function(){return Ho.call(this.children,t)}}function Wo(t){return this.selectAll(t==null?Io:zo(typeof t=="function"?t:_r(t)))}function qo(t){typeof t!="function"&&(t=vr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=[],l,a=0;a<s;++a)(l=o[a])&&t.call(l,l.__data__,a,o)&&u.push(l);return new Nt(r,this._parents)}function xr(t){return new Array(t.length)}function $o(){return new Nt(this._enter||this._groups.map(xr),this._parents)}function Qe(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Qe.prototype={constructor:Qe,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Bo(t){return function(){return t}}function Oo(t,e,n,r,i,o){for(var s=0,u,l=e.length,a=o.length;s<a;++s)(u=e[s])?(u.__data__=o[s],r[s]=u):n[s]=new Qe(t,o[s]);for(;s<l;++s)(u=e[s])&&(i[s]=u)}function Xo(t,e,n,r,i,o,s){var u,l,a=new Map,f=e.length,c=o.length,h=new Array(f),g;for(u=0;u<f;++u)(l=e[u])&&(h[u]=g=s.call(l,l.__data__,u,e)+"",a.has(g)?i[u]=l:a.set(g,l));for(u=0;u<c;++u)g=s.call(t,o[u],u,o)+"",(l=a.get(g))?(r[u]=l,l.__data__=o[u],a.delete(g)):n[u]=new Qe(t,o[u]);for(u=0;u<f;++u)(l=e[u])&&a.get(h[u])===l&&(i[u]=l)}function Vo(t){return t.__data__}function Go(t,e){if(!arguments.length)return Array.from(this,Vo);var n=e?Xo:Oo,r=this._parents,i=this._groups;typeof t!="function"&&(t=Bo(t));for(var o=i.length,s=new Array(o),u=new Array(o),l=new Array(o),a=0;a<o;++a){var f=r[a],c=i[a],h=c.length,g=Zo(t.call(f,f&&f.__data__,a,r)),w=g.length,x=u[a]=new Array(w),N=s[a]=new Array(w),R=l[a]=new Array(h);n(f,c,x,N,R,g,e);for(var H=0,p=0,_,b;H<w;++H)if(_=x[H]){for(H>=p&&(p=H+1);!(b=N[p])&&++p<w;);_._next=b||null}}return s=new Nt(s,r),s._enter=u,s._exit=l,s}function Zo(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Jo(){return new Nt(this._exit||this._groups.map(xr),this._parents)}function Qo(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ko(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),u=new Array(i),l=0;l<s;++l)for(var a=n[l],f=r[l],c=a.length,h=u[l]=new Array(c),g,w=0;w<c;++w)(g=a[w]||f[w])&&(h[w]=g);for(;l<i;++l)u[l]=n[l];return new Nt(u,this._parents)}function jo(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function ta(t){t||(t=ea);function e(c,h){return c&&h?t(c.__data__,h.__data__):!c-!h}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],u=s.length,l=i[o]=new Array(u),a,f=0;f<u;++f)(a=s[f])&&(l[f]=a);l.sort(e)}return new Nt(i,this._parents).order()}function ea(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function na(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ra(){return Array.from(this)}function ia(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function oa(){let t=0;for(const e of this)++t;return t}function aa(){return!this.node()}function sa(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,u;o<s;++o)(u=i[o])&&t.call(u,u.__data__,o,i);return this}function ua(t){return function(){this.removeAttribute(t)}}function la(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ca(t,e){return function(){this.setAttribute(t,e)}}function fa(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ha(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ga(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function da(t,e){var n=Je(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?la:ua:typeof e=="function"?n.local?ga:ha:n.local?fa:ca)(n,e))}function br(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ma(t){return function(){this.style.removeProperty(t)}}function pa(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ya(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function wa(t,e,n){return arguments.length>1?this.each((e==null?ma:typeof e=="function"?ya:pa)(t,e,n??"")):le(this.node(),t)}function le(t,e){return t.style.getPropertyValue(e)||br(t).getComputedStyle(t,null).getPropertyValue(e)}function va(t){return function(){delete this[t]}}function _a(t,e){return function(){this[t]=e}}function xa(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ba(t,e){return arguments.length>1?this.each((e==null?va:typeof e=="function"?xa:_a)(t,e)):this.node()[t]}function Mr(t){return t.trim().split(/^|\s+/)}function Sn(t){return t.classList||new Tr(t)}function Tr(t){this._node=t,this._names=Mr(t.getAttribute("class")||"")}Tr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Cr(t,e){for(var n=Sn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function kr(t,e){for(var n=Sn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Ma(t){return function(){Cr(this,t)}}function Ta(t){return function(){kr(this,t)}}function Ca(t,e){return function(){(e.apply(this,arguments)?Cr:kr)(this,t)}}function ka(t,e){var n=Mr(t+"");if(arguments.length<2){for(var r=Sn(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Ca:e?Ma:Ta)(n,e))}function Da(){this.textContent=""}function Na(t){return function(){this.textContent=t}}function Sa(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Aa(t){return arguments.length?this.each(t==null?Da:(typeof t=="function"?Sa:Na)(t)):this.node().textContent}function Fa(){this.innerHTML=""}function Ua(t){return function(){this.innerHTML=t}}function Ea(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ra(t){return arguments.length?this.each(t==null?Fa:(typeof t=="function"?Ea:Ua)(t)):this.node().innerHTML}function Ya(){this.nextSibling&&this.parentNode.appendChild(this)}function La(){return this.each(Ya)}function Pa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ha(){return this.each(Pa)}function Ia(t){var e=typeof t=="function"?t:yr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function za(){return null}function Wa(t,e){var n=typeof t=="function"?t:yr(t),r=e==null?za:typeof e=="function"?e:Nn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function qa(){var t=this.parentNode;t&&t.removeChild(this)}function $a(){return this.each(qa)}function Ba(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Oa(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Xa(t){return this.select(t?Oa:Ba)}function Va(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ga(t){return function(e){t.call(this,e,this.__data__)}}function Za(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ja(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Qa(t,e,n){return function(){var r=this.__on,i,o=Ga(e);if(r){for(var s=0,u=r.length;s<u;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Ka(t,e,n){var r=Za(t+""),i,o=r.length,s;if(arguments.length<2){var u=this.node().__on;if(u){for(var l=0,a=u.length,f;l<a;++l)for(i=0,f=u[l];i<o;++i)if((s=r[i]).type===f.type&&s.name===f.name)return f.value}return}for(u=e?Qa:Ja,i=0;i<o;++i)this.each(u(r[i],e,n));return this}function Dr(t,e,n){var r=br(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ja(t,e){return function(){return Dr(this,t,e)}}function ts(t,e){return function(){return Dr(this,t,e.apply(this,arguments))}}function es(t,e){return this.each((typeof e=="function"?ts:ja)(t,e))}function*ns(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var Nr=[null];function Nt(t,e){this._groups=t,this._parents=e}function De(){return new Nt([[document.documentElement]],Nr)}function rs(){return this}Nt.prototype=De.prototype={constructor:Nt,select:So,selectAll:Eo,selectChild:Po,selectChildren:Wo,filter:qo,data:Go,enter:$o,exit:Jo,join:Qo,merge:Ko,selection:rs,order:jo,sort:ta,call:na,nodes:ra,node:ia,size:oa,empty:aa,each:sa,attr:da,style:wa,property:ba,classed:ka,text:Aa,html:Ra,raise:La,lower:Ha,append:Ia,insert:Wa,remove:$a,clone:Xa,datum:Va,on:Ka,dispatch:es,[Symbol.iterator]:ns};function Xt(t){return typeof t=="string"?new Nt([[document.querySelector(t)]],[document.documentElement]):new Nt([[t]],Nr)}function An(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Sr(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ne(){}var Se=.7,Ke=1/Se,ce="\\s*([+-]?\\d+)\\s*",Ae="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",is=/^#([0-9a-f]{3,8})$/,os=new RegExp(`^rgb\\(${ce},${ce},${ce}\\)$`),as=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),ss=new RegExp(`^rgba\\(${ce},${ce},${ce},${Ae}\\)$`),us=new RegExp(`^rgba\\(${It},${It},${It},${Ae}\\)$`),ls=new RegExp(`^hsl\\(${Ae},${It},${It}\\)$`),cs=new RegExp(`^hsla\\(${Ae},${It},${It},${Ae}\\)$`),Ar={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};An(Ne,Zt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Fr,formatHex:Fr,formatHex8:fs,formatHsl:hs,formatRgb:Ur,toString:Ur});function Fr(){return this.rgb().formatHex()}function fs(){return this.rgb().formatHex8()}function hs(){return Pr(this).formatHsl()}function Ur(){return this.rgb().formatRgb()}function Zt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=is.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Er(e):n===3?new Dt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?je(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?je(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=os.exec(t))?new Dt(e[1],e[2],e[3],1):(e=as.exec(t))?new Dt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ss.exec(t))?je(e[1],e[2],e[3],e[4]):(e=us.exec(t))?je(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ls.exec(t))?Lr(e[1],e[2]/100,e[3]/100,1):(e=cs.exec(t))?Lr(e[1],e[2]/100,e[3]/100,e[4]):Ar.hasOwnProperty(t)?Er(Ar[t]):t==="transparent"?new Dt(NaN,NaN,NaN,0):null}function Er(t){return new Dt(t>>16&255,t>>8&255,t&255,1)}function je(t,e,n,r){return r<=0&&(t=e=n=NaN),new Dt(t,e,n,r)}function gs(t){return t instanceof Ne||(t=Zt(t)),t?(t=t.rgb(),new Dt(t.r,t.g,t.b,t.opacity)):new Dt}function Fn(t,e,n,r){return arguments.length===1?gs(t):new Dt(t,e,n,r??1)}function Dt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}An(Dt,Fn,Sr(Ne,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new Dt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Se:Math.pow(Se,t),new Dt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Dt(Jt(this.r),Jt(this.g),Jt(this.b),tn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Rr,formatHex:Rr,formatHex8:ds,formatRgb:Yr,toString:Yr}));function Rr(){return`#${Qt(this.r)}${Qt(this.g)}${Qt(this.b)}`}function ds(){return`#${Qt(this.r)}${Qt(this.g)}${Qt(this.b)}${Qt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Yr(){const t=tn(this.opacity);return`${t===1?"rgb(":"rgba("}${Jt(this.r)}, ${Jt(this.g)}, ${Jt(this.b)}${t===1?")":`, ${t})`}`}function tn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Jt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qt(t){return t=Jt(t),(t<16?"0":"")+t.toString(16)}function Lr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ut(t,e,n,r)}function Pr(t){if(t instanceof Ut)return new Ut(t.h,t.s,t.l,t.opacity);if(t instanceof Ne||(t=Zt(t)),!t)return new Ut;if(t instanceof Ut)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,u=o-i,l=(o+i)/2;return u?(e===o?s=(n-r)/u+(n<r)*6:n===o?s=(r-e)/u+2:s=(e-n)/u+4,u/=l<.5?o+i:2-o-i,s*=60):u=l>0&&l<1?0:s,new Ut(s,u,l,t.opacity)}function ms(t,e,n,r){return arguments.length===1?Pr(t):new Ut(t,e,n,r??1)}function Ut(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}An(Ut,ms,Sr(Ne,{brighter(t){return t=t==null?Ke:Math.pow(Ke,t),new Ut(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Se:Math.pow(Se,t),new Ut(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Dt(Un(t>=240?t-240:t+120,i,r),Un(t,i,r),Un(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ut(Hr(this.h),en(this.s),en(this.l),tn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=tn(this.opacity);return`${t===1?"hsl(":"hsla("}${Hr(this.h)}, ${en(this.s)*100}%, ${en(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Hr(t){return t=(t||0)%360,t<0?t+360:t}function en(t){return Math.max(0,Math.min(1,t||0))}function Un(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const En=t=>()=>t;function ps(t,e){return function(n){return t+n*e}}function ys(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ws(t){return(t=+t)==1?Ir:function(e,n){return n-e?ys(e,n,t):En(isNaN(e)?n:e)}}function Ir(t,e){var n=e-t;return n?ps(t,n):En(isNaN(t)?e:t)}const nn=function t(e){var n=ws(e);function r(i,o){var s=n((i=Fn(i)).r,(o=Fn(o)).r),u=n(i.g,o.g),l=n(i.b,o.b),a=Ir(i.opacity,o.opacity);return function(f){return i.r=s(f),i.g=u(f),i.b=l(f),i.opacity=a(f),i+""}}return r.gamma=t,r}(1);function vs(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function _s(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function xs(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=Ln(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(u){for(s=0;s<r;++s)o[s]=i[s](u);return o}}function bs(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Et(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ms(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Ln(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Rn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yn=new RegExp(Rn.source,"g");function Ts(t){return function(){return t}}function Cs(t){return function(e){return t(e)+""}}function zr(t,e){var n=Rn.lastIndex=Yn.lastIndex=0,r,i,o,s=-1,u=[],l=[];for(t=t+"",e=e+"";(r=Rn.exec(t))&&(i=Yn.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),u[s]?u[s]+=o:u[++s]=o),(r=r[0])===(i=i[0])?u[s]?u[s]+=i:u[++s]=i:(u[++s]=null,l.push({i:s,x:Et(r,i)})),n=Yn.lastIndex;return n<e.length&&(o=e.slice(n),u[s]?u[s]+=o:u[++s]=o),u.length<2?l[0]?Cs(l[0].x):Ts(e):(e=l.length,function(a){for(var f=0,c;f<e;++f)u[(c=l[f]).i]=c.x(a);return u.join("")})}function Ln(t,e){var n=typeof e,r;return e==null||n==="boolean"?En(e):(n==="number"?Et:n==="string"?(r=Zt(e))?(e=r,nn):zr:e instanceof Zt?nn:e instanceof Date?bs:_s(e)?vs:Array.isArray(e)?xs:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ms:Et)(t,e)}function ks(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Wr=180/Math.PI,Pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qr(t,e,n,r,i,o){var s,u,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Wr,skewX:Math.atan(l)*Wr,scaleX:s,scaleY:u}}var rn;function Ds(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Pn:qr(e.a,e.b,e.c,e.d,e.e,e.f)}function Ns(t){return t==null||(rn||(rn=document.createElementNS("http://www.w3.org/2000/svg","g")),rn.setAttribute("transform",t),!(t=rn.transform.baseVal.consolidate()))?Pn:(t=t.matrix,qr(t.a,t.b,t.c,t.d,t.e,t.f))}function $r(t,e,n,r){function i(a){return a.length?a.pop()+" ":""}function o(a,f,c,h,g,w){if(a!==c||f!==h){var x=g.push("translate(",null,e,null,n);w.push({i:x-4,x:Et(a,c)},{i:x-2,x:Et(f,h)})}else(c||h)&&g.push("translate("+c+e+h+n)}function s(a,f,c,h){a!==f?(a-f>180?f+=360:f-a>180&&(a+=360),h.push({i:c.push(i(c)+"rotate(",null,r)-2,x:Et(a,f)})):f&&c.push(i(c)+"rotate("+f+r)}function u(a,f,c,h){a!==f?h.push({i:c.push(i(c)+"skewX(",null,r)-2,x:Et(a,f)}):f&&c.push(i(c)+"skewX("+f+r)}function l(a,f,c,h,g,w){if(a!==c||f!==h){var x=g.push(i(g)+"scale(",null,",",null,")");w.push({i:x-4,x:Et(a,c)},{i:x-2,x:Et(f,h)})}else(c!==1||h!==1)&&g.push(i(g)+"scale("+c+","+h+")")}return function(a,f){var c=[],h=[];return a=t(a),f=t(f),o(a.translateX,a.translateY,f.translateX,f.translateY,c,h),s(a.rotate,f.rotate,c,h),u(a.skewX,f.skewX,c,h),l(a.scaleX,a.scaleY,f.scaleX,f.scaleY,c,h),a=f=null,function(g){for(var w=-1,x=h.length,N;++w<x;)c[(N=h[w]).i]=N.x(g);return c.join("")}}}var Ss=$r(Ds,"px, ","px)","deg)"),As=$r(Ns,", ",")",")"),fe=0,Fe=0,Ue=0,Br=1e3,on,Ee,an=0,Kt=0,sn=0,Re=typeof performance=="object"&&performance.now?performance:Date,Or=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Hn(){return Kt||(Or(Fs),Kt=Re.now()+sn)}function Fs(){Kt=0}function un(){this._call=this._time=this._next=null}un.prototype=Xr.prototype={constructor:un,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Hn():+n)+(e==null?0:+e),!this._next&&Ee!==this&&(Ee?Ee._next=this:on=this,Ee=this),this._call=t,this._time=n,In()},stop:function(){this._call&&(this._call=null,this._time=1/0,In())}};function Xr(t,e,n){var r=new un;return r.restart(t,e,n),r}function Us(){Hn(),++fe;for(var t=on,e;t;)(e=Kt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--fe}function Vr(){Kt=(an=Re.now())+sn,fe=Fe=0;try{Us()}finally{fe=0,Rs(),Kt=0}}function Es(){var t=Re.now(),e=t-an;e>Br&&(sn-=e,an=t)}function Rs(){for(var t,e=on,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:on=n);Ee=t,In(r)}function In(t){if(!fe){Fe&&(Fe=clearTimeout(Fe));var e=t-Kt;e>24?(t<1/0&&(Fe=setTimeout(Vr,t-Re.now()-sn)),Ue&&(Ue=clearInterval(Ue))):(Ue||(an=Re.now(),Ue=setInterval(Es,Br)),fe=1,Or(Vr))}}function Gr(t,e,n){var r=new un;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Ys=dr("start","end","cancel","interrupt"),Ls=[],Zr=0,Jr=1,zn=2,ln=3,Qr=4,Wn=5,cn=6;function fn(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Ps(t,n,{name:e,index:r,group:i,on:Ys,tween:Ls,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Zr})}function qn(t,e){var n=Rt(t,e);if(n.state>Zr)throw new Error("too late; already scheduled");return n}function zt(t,e){var n=Rt(t,e);if(n.state>ln)throw new Error("too late; already running");return n}function Rt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ps(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Xr(o,0,n.time);function o(a){n.state=Jr,n.timer.restart(s,n.delay,n.time),n.delay<=a&&s(a-n.delay)}function s(a){var f,c,h,g;if(n.state!==Jr)return l();for(f in r)if(g=r[f],g.name===n.name){if(g.state===ln)return Gr(s);g.state===Qr?(g.state=cn,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[f]):+f<e&&(g.state=cn,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[f])}if(Gr(function(){n.state===ln&&(n.state=Qr,n.timer.restart(u,n.delay,n.time),u(a))}),n.state=zn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===zn){for(n.state=ln,i=new Array(h=n.tween.length),f=0,c=-1;f<h;++f)(g=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=g);i.length=c+1}}function u(a){for(var f=a<n.duration?n.ease.call(null,a/n.duration):(n.timer.restart(l),n.state=Wn,1),c=-1,h=i.length;++c<h;)i[c].call(t,f);n.state===Wn&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=cn,n.timer.stop(),delete r[e];for(var a in r)return;delete t.__transition}}function Hs(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>zn&&r.state<Wn,r.state=cn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function Is(t){return this.each(function(){Hs(this,t)})}function zs(t,e){var n,r;return function(){var i=zt(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,u=r.length;s<u;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Ws(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=zt(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var u={name:e,value:n},l=0,a=i.length;l<a;++l)if(i[l].name===e){i[l]=u;break}l===a&&i.push(u)}o.tween=i}}function qs(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Rt(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?zs:Ws)(n,t,e))}function $n(t,e,n){var r=t._id;return t.each(function(){var i=zt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Rt(i,r).value[e]}}function Kr(t,e){var n;return(typeof e=="number"?Et:e instanceof Zt?nn:(n=Zt(e))?(e=n,nn):zr)(t,e)}function $s(t){return function(){this.removeAttribute(t)}}function Bs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Os(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function Xs(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function Vs(t,e,n){var r,i,o;return function(){var s,u=n(this),l;return u==null?void this.removeAttribute(t):(s=this.getAttribute(t),l=u+"",s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,u)))}}function Gs(t,e,n){var r,i,o;return function(){var s,u=n(this),l;return u==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),l=u+"",s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,u)))}}function Zs(t,e){var n=Je(t),r=n==="transform"?As:Kr;return this.attrTween(t,typeof e=="function"?(n.local?Gs:Vs)(n,r,$n(this,"attr."+t,e)):e==null?(n.local?Bs:$s)(n):(n.local?Xs:Os)(n,r,e))}function Js(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Qs(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ks(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Qs(t,o)),n}return i._value=e,i}function js(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Js(t,o)),n}return i._value=e,i}function tu(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Je(t);return this.tween(n,(r.local?Ks:js)(r,e))}function eu(t,e){return function(){qn(this,t).delay=+e.apply(this,arguments)}}function nu(t,e){return e=+e,function(){qn(this,t).delay=e}}function ru(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?eu:nu)(e,t)):Rt(this.node(),e).delay}function iu(t,e){return function(){zt(this,t).duration=+e.apply(this,arguments)}}function ou(t,e){return e=+e,function(){zt(this,t).duration=e}}function au(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?iu:ou)(e,t)):Rt(this.node(),e).duration}function su(t,e){if(typeof e!="function")throw new Error;return function(){zt(this,t).ease=e}}function uu(t){var e=this._id;return arguments.length?this.each(su(e,t)):Rt(this.node(),e).ease}function lu(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;zt(this,t).ease=n}}function cu(t){if(typeof t!="function")throw new Error;return this.each(lu(this._id,t))}function fu(t){typeof t!="function"&&(t=vr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=[],l,a=0;a<s;++a)(l=o[a])&&t.call(l,l.__data__,a,o)&&u.push(l);return new Bt(r,this._parents,this._name,this._id)}function hu(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),u=0;u<o;++u)for(var l=e[u],a=n[u],f=l.length,c=s[u]=new Array(f),h,g=0;g<f;++g)(h=l[g]||a[g])&&(c[g]=h);for(;u<r;++u)s[u]=e[u];return new Bt(s,this._parents,this._name,this._id)}function gu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function du(t,e,n){var r,i,o=gu(e)?qn:zt;return function(){var s=o(this,t),u=s.on;u!==r&&(i=(r=u).copy()).on(e,n),s.on=i}}function mu(t,e){var n=this._id;return arguments.length<2?Rt(this.node(),n).on.on(t):this.each(du(n,t,e))}function pu(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function yu(){return this.on("end.remove",pu(this._id))}function wu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Nn(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var u=r[s],l=u.length,a=o[s]=new Array(l),f,c,h=0;h<l;++h)(f=u[h])&&(c=t.call(f,f.__data__,h,u))&&("__data__"in f&&(c.__data__=f.__data__),a[h]=c,fn(a[h],e,n,h,a,Rt(f,n)));return new Bt(o,this._parents,e,n)}function vu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=wr(t));for(var r=this._groups,i=r.length,o=[],s=[],u=0;u<i;++u)for(var l=r[u],a=l.length,f,c=0;c<a;++c)if(f=l[c]){for(var h=t.call(f,f.__data__,c,l),g,w=Rt(f,n),x=0,N=h.length;x<N;++x)(g=h[x])&&fn(g,e,n,x,h,w);o.push(h),s.push(f)}return new Bt(o,s,e,n)}var _u=De.prototype.constructor;function xu(){return new _u(this._groups,this._parents)}function bu(t,e){var n,r,i;return function(){var o=le(this,t),s=(this.style.removeProperty(t),le(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function jr(t){return function(){this.style.removeProperty(t)}}function Mu(t,e,n){var r,i=n+"",o;return function(){var s=le(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function Tu(t,e,n){var r,i,o;return function(){var s=le(this,t),u=n(this),l=u+"";return u==null&&(l=u=(this.style.removeProperty(t),le(this,t))),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,u))}}function Cu(t,e){var n,r,i,o="style."+e,s="end."+o,u;return function(){var l=zt(this,t),a=l.on,f=l.value[o]==null?u||(u=jr(e)):void 0;(a!==n||i!==f)&&(r=(n=a).copy()).on(s,i=f),l.on=r}}function ku(t,e,n){var r=(t+="")=="transform"?Ss:Kr;return e==null?this.styleTween(t,bu(t,r)).on("end.style."+t,jr(t)):typeof e=="function"?this.styleTween(t,Tu(t,r,$n(this,"style."+t,e))).each(Cu(this._id,t)):this.styleTween(t,Mu(t,r,e),n).on("end.style."+t,null)}function Du(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Nu(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Du(t,s,n)),r}return o._value=e,o}function Su(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Nu(t,e,n??""))}function Au(t){return function(){this.textContent=t}}function Fu(t){return function(){var e=t(this);this.textContent=e??""}}function Uu(t){return this.tween("text",typeof t=="function"?Fu($n(this,"text",t)):Au(t==null?"":t+""))}function Eu(t){return function(e){this.textContent=t.call(this,e)}}function Ru(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Eu(i)),e}return r._value=t,r}function Yu(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ru(t))}function Lu(){for(var t=this._name,e=this._id,n=ti(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],u=s.length,l,a=0;a<u;++a)if(l=s[a]){var f=Rt(l,e);fn(l,t,n,a,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Bt(r,this._parents,t,n)}function Pu(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var u={value:s},l={value:function(){--i===0&&o()}};n.each(function(){var a=zt(this,r),f=a.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),a.on=e}),i===0&&o()})}var Hu=0;function Bt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function ti(){return++Hu}var Ot=De.prototype;Bt.prototype={constructor:Bt,select:wu,selectAll:vu,selectChild:Ot.selectChild,selectChildren:Ot.selectChildren,filter:fu,merge:hu,selection:xu,transition:Lu,call:Ot.call,nodes:Ot.nodes,node:Ot.node,size:Ot.size,empty:Ot.empty,each:Ot.each,on:mu,attr:Zs,attrTween:tu,style:ku,styleTween:Su,text:Uu,textTween:Yu,remove:yu,tween:qs,delay:ru,duration:au,ease:uu,easeVarying:cu,end:Pu,[Symbol.iterator]:Ot[Symbol.iterator]};function Iu(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var zu={time:null,delay:0,duration:250,ease:Iu};function Wu(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function qu(t){var e,n;t instanceof Bt?(e=t._id,t=t._name):(e=ti(),(n=zu).time=Hn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],u=s.length,l,a=0;a<u;++a)(l=s[a])&&fn(l,t,e,a,s,n||Wu(l,e));return new Bt(r,this._parents,t,e)}De.prototype.interrupt=Is,De.prototype.transition=qu;const Bn=Math.PI,On=2*Bn,jt=1e-6,$u=On-jt;function ei(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Bu(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return ei;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Ou{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?ei:Bu(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,s){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,u=this._y1,l=r-e,a=i-n,f=s-e,c=u-n,h=f*f+c*c;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>jt)if(!(Math.abs(c*l-a*f)>jt)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let g=r-s,w=i-u,x=l*l+a*a,N=g*g+w*w,R=Math.sqrt(x),H=Math.sqrt(h),p=o*Math.tan((Bn-Math.acos((x+h-N)/(2*R*H)))/2),_=p/H,b=p/R;Math.abs(_-1)>jt&&this._append`L${e+_*f},${n+_*c}`,this._append`A${o},${o},0,0,${+(c*g>f*w)},${this._x1=e+b*l},${this._y1=n+b*a}`}}arc(e,n,r,i,o,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),l=r*Math.sin(i),a=e+u,f=n+l,c=1^s,h=s?i-o:o-i;this._x1===null?this._append`M${a},${f}`:(Math.abs(this._x1-a)>jt||Math.abs(this._y1-f)>jt)&&this._append`L${a},${f}`,r&&(h<0&&(h=h%On+On),h>$u?this._append`A${r},${r},0,1,${c},${e-u},${n-l}A${r},${r},0,1,${c},${this._x1=a},${this._y1=f}`:h>jt&&this._append`A${r},${r},0,${+(h>=Bn)},${c},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Xu(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function hn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function he(t){return t=hn(Math.abs(t)),t?t[1]:NaN}function Vu(t,e){return function(n,r){for(var i=n.length,o=[],s=0,u=t[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),o.push(n.substring(i-=u,i+u)),!((l+=u+1)>r));)u=t[s=(s+1)%t.length];return o.reverse().join(e)}}function Gu(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Zu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gn(t){if(!(e=Zu.exec(t)))throw new Error("invalid format: "+t);var e;return new Xn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}gn.prototype=Xn.prototype;function Xn(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Xn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ju(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ni;function Qu(t,e){var n=hn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ni=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+hn(t,Math.max(0,e+o-1))[0]}function ri(t,e){var n=hn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ii={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Xu,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ri(t*100,e),r:ri,s:Qu,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function oi(t){return t}var ai=Array.prototype.map,si=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ku(t){var e=t.grouping===void 0||t.thousands===void 0?oi:Vu(ai.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?oi:Gu(ai.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function a(c){c=gn(c);var h=c.fill,g=c.align,w=c.sign,x=c.symbol,N=c.zero,R=c.width,H=c.comma,p=c.precision,_=c.trim,b=c.type;b==="n"?(H=!0,b="g"):ii[b]||(p===void 0&&(p=12),_=!0,b="g"),(N||h==="0"&&g==="=")&&(N=!0,h="0",g="=");var k=x==="$"?n:x==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",E=x==="$"?r:/[%p]/.test(b)?s:"",Z=ii[b],X=/[defgprs%]/.test(b);p=p===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function L(m){var V=k,A=E,D,G,ot;if(b==="c")A=Z(m)+A,m="";else{m=+m;var ct=m<0||1/m<0;if(m=isNaN(m)?l:Z(Math.abs(m),p),_&&(m=Ju(m)),ct&&+m==0&&w!=="+"&&(ct=!1),V=(ct?w==="("?w:u:w==="-"||w==="("?"":w)+V,A=(b==="s"?si[8+ni/3]:"")+A+(ct&&w==="("?")":""),X){for(D=-1,G=m.length;++D<G;)if(ot=m.charCodeAt(D),48>ot||ot>57){A=(ot===46?i+m.slice(D+1):m.slice(D))+A,m=m.slice(0,D);break}}}H&&!N&&(m=e(m,1/0));var ft=V.length+m.length+A.length,et=ft<R?new Array(R-ft+1).join(h):"";switch(H&&N&&(m=e(et+m,et.length?R-A.length:1/0),et=""),g){case"<":m=V+m+A+et;break;case"=":m=V+et+m+A;break;case"^":m=et.slice(0,ft=et.length>>1)+V+m+A+et.slice(ft);break;default:m=et+V+m+A;break}return o(m)}return L.toString=function(){return c+""},L}function f(c,h){var g=a((c=gn(c),c.type="f",c)),w=Math.max(-8,Math.min(8,Math.floor(he(h)/3)))*3,x=Math.pow(10,-w),N=si[8+w/3];return function(R){return g(x*R)+N}}return{format:a,formatPrefix:f}}var dn,ui,li;ju({thousands:",",grouping:[3],currency:["$",""]});function ju(t){return dn=Ku(t),ui=dn.format,li=dn.formatPrefix,dn}function tl(t){return Math.max(0,-he(Math.abs(t)))}function el(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(he(e)/3)))*3-he(Math.abs(t)))}function nl(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,he(e)-he(t))+1}function rl(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function il(t){return function(){return t}}function ol(t){return+t}var ci=[0,1];function ge(t){return t}function Vn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:il(isNaN(e)?NaN:.5)}function al(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function sl(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=Vn(i,r),o=n(s,o)):(r=Vn(r,i),o=n(o,s)),function(u){return o(r(u))}}function ul(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=Vn(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(u){var l=ao(t,u,1,r)-1;return o[l](i[l](u))}}function ll(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function cl(){var t=ci,e=ci,n=Ln,r,i,o,s=ge,u,l,a;function f(){var h=Math.min(t.length,e.length);return s!==ge&&(s=al(t[0],t[h-1])),u=h>2?ul:sl,l=a=null,c}function c(h){return h==null||isNaN(h=+h)?o:(l||(l=u(t.map(r),e,n)))(r(s(h)))}return c.invert=function(h){return s(i((a||(a=u(e,t.map(r),Et)))(h)))},c.domain=function(h){return arguments.length?(t=Array.from(h,ol),f()):t.slice()},c.range=function(h){return arguments.length?(e=Array.from(h),f()):e.slice()},c.rangeRound=function(h){return e=Array.from(h),n=ks,f()},c.clamp=function(h){return arguments.length?(s=h?!0:ge,f()):s!==ge},c.interpolate=function(h){return arguments.length?(n=h,f()):n},c.unknown=function(h){return arguments.length?(o=h,c):o},function(h,g){return r=h,i=g,f()}}function fl(){return cl()(ge,ge)}function hl(t,e,n,r){var i=ho(t,e,n),o;switch(r=gn(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=el(i,s))&&(r.precision=o),li(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=nl(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=tl(i))&&(r.precision=o-(r.type==="%")*2);break}}return ui(r)}function gl(t){var e=t.domain;return t.ticks=function(n){var r=e();return fo(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return hl(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,s=r[i],u=r[o],l,a,f=10;for(u<s&&(a=s,s=u,u=a,a=i,i=o,o=a);f-- >0;){if(a=bn(s,u,n),a===l)return r[i]=s,r[o]=u,e(r);if(a>0)s=Math.floor(s/a)*a,u=Math.ceil(u/a)*a;else if(a<0)s=Math.ceil(s*a)/a,u=Math.floor(u*a)/a;else break;l=a}return t},t}function Ye(){var t=fl();return t.copy=function(){return ll(t,Ye())},rl.apply(t,arguments),gl(t)}const Gn=new Date,Zn=new Date;function Wt(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const s=i(o),u=i.ceil(o);return o-s<u-o?s:u},i.offset=(o,s)=>(e(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,u)=>{const l=[];if(o=i.ceil(o),u=u==null?1:Math.floor(u),!(o<s)||!(u>0))return l;let a;do l.push(a=new Date(+o)),e(o,u),t(o);while(a<o&&o<s);return l},i.filter=o=>Wt(s=>{if(s>=s)for(;t(s),!o(s);)s.setTime(s-1)},(s,u)=>{if(s>=s)if(u<0)for(;++u<=0;)for(;e(s,-1),!o(s););else for(;--u>=0;)for(;e(s,1),!o(s););}),n&&(i.count=(o,s)=>(Gn.setTime(+o),Zn.setTime(+s),t(Gn),t(Zn),Math.floor(n(Gn,Zn))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const Jn=1e3*60,Le=Jn*60*24,fi=Le*7,Pe=Wt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Jn)/Le,t=>t.getDate()-1);Pe.range;const Qn=Wt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Le,t=>t.getUTCDate()-1);Qn.range,Wt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Le,t=>Math.floor(t/Le)).range;function te(t){return Wt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Jn)/fi)}const hi=te(0),mn=te(1),dl=te(2),ml=te(3),de=te(4),pl=te(5),yl=te(6);hi.range,mn.range,dl.range,ml.range,de.range,pl.range,yl.range;function ee(t){return Wt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/fi)}const gi=ee(0),pn=ee(1),wl=ee(2),vl=ee(3),me=ee(4),_l=ee(5),xl=ee(6);gi.range,pn.range,wl.range,vl.range,me.range,_l.range,xl.range;const ne=Wt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ne.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)}),ne.range;const re=Wt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());re.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Wt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}),re.range;function Kn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function He(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function bl(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,u=t.months,l=t.shortMonths,a=Ie(i),f=ze(i),c=Ie(o),h=ze(o),g=Ie(s),w=ze(s),x=Ie(u),N=ze(u),R=Ie(l),H=ze(l),p={a:ct,A:ft,b:et,B:_t,c:null,d:vi,e:vi,f:Ol,g:ec,G:rc,H:ql,I:$l,j:Bl,L:_i,m:Xl,M:Vl,p:pt,q:kt,Q:ki,s:Di,S:Gl,u:Zl,U:Jl,V:Ql,w:Kl,W:jl,x:null,X:null,y:tc,Y:nc,Z:ic,"%":Ci},_={a:ht,A:qt,b:St,B:rt,c:null,d:bi,e:bi,f:uc,g:wc,G:_c,H:oc,I:ac,j:sc,L:Mi,m:lc,M:cc,p:xt,q:d,Q:ki,s:Di,S:fc,u:hc,U:gc,V:dc,w:mc,W:pc,x:null,X:null,y:yc,Y:vc,Z:xc,"%":Ci},b={a:L,A:m,b:V,B:A,c:D,d:yi,e:yi,f:Hl,g:pi,G:mi,H:wi,I:wi,j:Rl,L:Pl,m:El,M:Yl,p:X,q:Ul,Q:zl,s:Wl,S:Ll,u:Dl,U:Nl,V:Sl,w:kl,W:Al,x:G,X:ot,y:pi,Y:mi,Z:Fl,"%":Il};p.x=k(n,p),p.X=k(r,p),p.c=k(e,p),_.x=k(n,_),_.X=k(r,_),_.c=k(e,_);function k(M,z){return function(B){var y=[],K=-1,Y=0,v=M.length,S,F,U;for(B instanceof Date||(B=new Date(+B));++K<v;)M.charCodeAt(K)===37&&(y.push(M.slice(Y,K)),(F=di[S=M.charAt(++K)])!=null?S=M.charAt(++K):F=S==="e"?" ":"0",(U=z[S])&&(S=U(B,F)),y.push(S),Y=K+1);return y.push(M.slice(Y,K)),y.join("")}}function E(M,z){return function(B){var y=He(1900,void 0,1),K=Z(y,M,B+="",0),Y,v;if(K!=B.length)return null;if("Q"in y)return new Date(y.Q);if("s"in y)return new Date(y.s*1e3+("L"in y?y.L:0));if(z&&!("Z"in y)&&(y.Z=0),"p"in y&&(y.H=y.H%12+y.p*12),y.m===void 0&&(y.m="q"in y?y.q:0),"V"in y){if(y.V<1||y.V>53)return null;"w"in y||(y.w=1),"Z"in y?(Y=jn(He(y.y,0,1)),v=Y.getUTCDay(),Y=v>4||v===0?pn.ceil(Y):pn(Y),Y=Qn.offset(Y,(y.V-1)*7),y.y=Y.getUTCFullYear(),y.m=Y.getUTCMonth(),y.d=Y.getUTCDate()+(y.w+6)%7):(Y=Kn(He(y.y,0,1)),v=Y.getDay(),Y=v>4||v===0?mn.ceil(Y):mn(Y),Y=Pe.offset(Y,(y.V-1)*7),y.y=Y.getFullYear(),y.m=Y.getMonth(),y.d=Y.getDate()+(y.w+6)%7)}else("W"in y||"U"in y)&&("w"in y||(y.w="u"in y?y.u%7:"W"in y?1:0),v="Z"in y?jn(He(y.y,0,1)).getUTCDay():Kn(He(y.y,0,1)).getDay(),y.m=0,y.d="W"in y?(y.w+6)%7+y.W*7-(v+5)%7:y.w+y.U*7-(v+6)%7);return"Z"in y?(y.H+=y.Z/100|0,y.M+=y.Z%100,jn(y)):Kn(y)}}function Z(M,z,B,y){for(var K=0,Y=z.length,v=B.length,S,F;K<Y;){if(y>=v)return-1;if(S=z.charCodeAt(K++),S===37){if(S=z.charAt(K++),F=b[S in di?z.charAt(K++):S],!F||(y=F(M,B,y))<0)return-1}else if(S!=B.charCodeAt(y++))return-1}return y}function X(M,z,B){var y=a.exec(z.slice(B));return y?(M.p=f.get(y[0].toLowerCase()),B+y[0].length):-1}function L(M,z,B){var y=g.exec(z.slice(B));return y?(M.w=w.get(y[0].toLowerCase()),B+y[0].length):-1}function m(M,z,B){var y=c.exec(z.slice(B));return y?(M.w=h.get(y[0].toLowerCase()),B+y[0].length):-1}function V(M,z,B){var y=R.exec(z.slice(B));return y?(M.m=H.get(y[0].toLowerCase()),B+y[0].length):-1}function A(M,z,B){var y=x.exec(z.slice(B));return y?(M.m=N.get(y[0].toLowerCase()),B+y[0].length):-1}function D(M,z,B){return Z(M,e,z,B)}function G(M,z,B){return Z(M,n,z,B)}function ot(M,z,B){return Z(M,r,z,B)}function ct(M){return s[M.getDay()]}function ft(M){return o[M.getDay()]}function et(M){return l[M.getMonth()]}function _t(M){return u[M.getMonth()]}function pt(M){return i[+(M.getHours()>=12)]}function kt(M){return 1+~~(M.getMonth()/3)}function ht(M){return s[M.getUTCDay()]}function qt(M){return o[M.getUTCDay()]}function St(M){return l[M.getUTCMonth()]}function rt(M){return u[M.getUTCMonth()]}function xt(M){return i[+(M.getUTCHours()>=12)]}function d(M){return 1+~~(M.getUTCMonth()/3)}return{format:function(M){var z=k(M+="",p);return z.toString=function(){return M},z},parse:function(M){var z=E(M+="",!1);return z.toString=function(){return M},z},utcFormat:function(M){var z=k(M+="",_);return z.toString=function(){return M},z},utcParse:function(M){var z=E(M+="",!0);return z.toString=function(){return M},z}}}var di={"-":"",_:" ",0:"0"},bt=/^\s*\d+/,Ml=/^%/,Tl=/[\\^$*+?|[\]().{}]/g;function j(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Cl(t){return t.replace(Tl,"\\$&")}function Ie(t){return new RegExp("^(?:"+t.map(Cl).join("|")+")","i")}function ze(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function kl(t,e,n){var r=bt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Dl(t,e,n){var r=bt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Nl(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Sl(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Al(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function mi(t,e,n){var r=bt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function pi(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Fl(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ul(t,e,n){var r=bt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function El(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function yi(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Rl(t,e,n){var r=bt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function wi(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Yl(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Ll(t,e,n){var r=bt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Pl(t,e,n){var r=bt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Hl(t,e,n){var r=bt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Il(t,e,n){var r=Ml.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function zl(t,e,n){var r=bt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Wl(t,e,n){var r=bt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function vi(t,e){return j(t.getDate(),e,2)}function ql(t,e){return j(t.getHours(),e,2)}function $l(t,e){return j(t.getHours()%12||12,e,2)}function Bl(t,e){return j(1+Pe.count(ne(t),t),e,3)}function _i(t,e){return j(t.getMilliseconds(),e,3)}function Ol(t,e){return _i(t,e)+"000"}function Xl(t,e){return j(t.getMonth()+1,e,2)}function Vl(t,e){return j(t.getMinutes(),e,2)}function Gl(t,e){return j(t.getSeconds(),e,2)}function Zl(t){var e=t.getDay();return e===0?7:e}function Jl(t,e){return j(hi.count(ne(t)-1,t),e,2)}function xi(t){var e=t.getDay();return e>=4||e===0?de(t):de.ceil(t)}function Ql(t,e){return t=xi(t),j(de.count(ne(t),t)+(ne(t).getDay()===4),e,2)}function Kl(t){return t.getDay()}function jl(t,e){return j(mn.count(ne(t)-1,t),e,2)}function tc(t,e){return j(t.getFullYear()%100,e,2)}function ec(t,e){return t=xi(t),j(t.getFullYear()%100,e,2)}function nc(t,e){return j(t.getFullYear()%1e4,e,4)}function rc(t,e){var n=t.getDay();return t=n>=4||n===0?de(t):de.ceil(t),j(t.getFullYear()%1e4,e,4)}function ic(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+j(e/60|0,"0",2)+j(e%60,"0",2)}function bi(t,e){return j(t.getUTCDate(),e,2)}function oc(t,e){return j(t.getUTCHours(),e,2)}function ac(t,e){return j(t.getUTCHours()%12||12,e,2)}function sc(t,e){return j(1+Qn.count(re(t),t),e,3)}function Mi(t,e){return j(t.getUTCMilliseconds(),e,3)}function uc(t,e){return Mi(t,e)+"000"}function lc(t,e){return j(t.getUTCMonth()+1,e,2)}function cc(t,e){return j(t.getUTCMinutes(),e,2)}function fc(t,e){return j(t.getUTCSeconds(),e,2)}function hc(t){var e=t.getUTCDay();return e===0?7:e}function gc(t,e){return j(gi.count(re(t)-1,t),e,2)}function Ti(t){var e=t.getUTCDay();return e>=4||e===0?me(t):me.ceil(t)}function dc(t,e){return t=Ti(t),j(me.count(re(t),t)+(re(t).getUTCDay()===4),e,2)}function mc(t){return t.getUTCDay()}function pc(t,e){return j(pn.count(re(t)-1,t),e,2)}function yc(t,e){return j(t.getUTCFullYear()%100,e,2)}function wc(t,e){return t=Ti(t),j(t.getUTCFullYear()%100,e,2)}function vc(t,e){return j(t.getUTCFullYear()%1e4,e,4)}function _c(t,e){var n=t.getUTCDay();return t=n>=4||n===0?me(t):me.ceil(t),j(t.getUTCFullYear()%1e4,e,4)}function xc(){return"+0000"}function Ci(){return"%"}function ki(t){return+t}function Di(t){return Math.floor(+t/1e3)}var pe,We,Ni;bc({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function bc(t){return pe=bl(t),We=pe.format,pe.parse,Ni=pe.utcFormat,pe.utcParse,pe}function Mt(t){return function(){return t}}function Si(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Ou(e)}function Ai(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Fi(t){this._context=t}Fi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Ui(t){return new Fi(t)}function Ei(t){return t[0]}function Ri(t){return t[1]}function qe(t,e){var n=Mt(!0),r=null,i=Ui,o=null,s=Si(u);t=typeof t=="function"?t:t===void 0?Ei:Mt(t),e=typeof e=="function"?e:e===void 0?Ri:Mt(e);function u(l){var a,f=(l=Ai(l)).length,c,h=!1,g;for(r==null&&(o=i(g=s())),a=0;a<=f;++a)!(a<f&&n(c=l[a],a,l))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(c,a,l),+e(c,a,l));if(g)return o=null,g+""||null}return u.x=function(l){return arguments.length?(t=typeof l=="function"?l:Mt(+l),u):t},u.y=function(l){return arguments.length?(e=typeof l=="function"?l:Mt(+l),u):e},u.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Mt(!!l),u):n},u.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),u):i},u.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),u):r},u}function Yt(t,e,n){var r=null,i=Mt(!0),o=null,s=Ui,u=null,l=Si(a);t=typeof t=="function"?t:t===void 0?Ei:Mt(+t),e=typeof e=="function"?e:Mt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Ri:Mt(+n);function a(c){var h,g,w,x=(c=Ai(c)).length,N,R=!1,H,p=new Array(x),_=new Array(x);for(o==null&&(u=s(H=l())),h=0;h<=x;++h){if(!(h<x&&i(N=c[h],h,c))===R)if(R=!R)g=h,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),w=h-1;w>=g;--w)u.point(p[w],_[w]);u.lineEnd(),u.areaEnd()}R&&(p[h]=+t(N,h,c),_[h]=+e(N,h,c),u.point(r?+r(N,h,c):p[h],n?+n(N,h,c):_[h]))}if(H)return u=null,H+""||null}function f(){return qe().defined(i).curve(s).context(o)}return a.x=function(c){return arguments.length?(t=typeof c=="function"?c:Mt(+c),r=null,a):t},a.x0=function(c){return arguments.length?(t=typeof c=="function"?c:Mt(+c),a):t},a.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Mt(+c),a):r},a.y=function(c){return arguments.length?(e=typeof c=="function"?c:Mt(+c),n=null,a):e},a.y0=function(c){return arguments.length?(e=typeof c=="function"?c:Mt(+c),a):e},a.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Mt(+c),a):n},a.lineX0=a.lineY0=function(){return f().x(t).y(e)},a.lineY1=function(){return f().x(t).y(n)},a.lineX1=function(){return f().x(r).y(e)},a.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Mt(!!c),a):i},a.curve=function(c){return arguments.length?(s=c,o!=null&&(u=s(o)),a):s},a.context=function(c){return arguments.length?(c==null?o=u=null:u=s(o=c),a):o},a}function Yi(t){return t<0?-1:1}function Li(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),u=(o*i+s*r)/(r+i);return(Yi(o)+Yi(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(u))||0}function Pi(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function tr(t,e,n){var r=t._x0,i=t._y0,o=t._x1,s=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*e,o-u,s-u*n,o,s)}function yn(t){this._context=t}yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tr(this,this._t0,Pi(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,tr(this,Pi(this,n=Li(this,t,e)),n);break;default:tr(this,this._t0,n=Li(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},Object.create(yn.prototype).point=function(t,e){yn.prototype.point.call(this,e,t)};function er(t){return new yn(t)}function $e(t,e,n){this.k=t,this.x=e,this.y=n}$e.prototype={constructor:$e,scale:function(t){return t===1?this:new $e(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new $e(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},$e.prototype;function Mc(t){let e,n,r,i,o,s,u,l,a,f,c,h,g,w,x,N,R,H,p,_,b,k,E,Z,X,L,m,V,A,D,G,ot,ct,ft,et,_t,pt,kt,ht,qt,St,rt,xt;return{c(){e=$("div"),n=$("div"),r=$("div"),i=dt(t[3]),o=yt(),s=$("div"),u=$("div"),l=$("button"),l.textContent="|<",a=yt(),f=$("button"),f.textContent="<",c=yt(),h=$("button"),h.textContent=">",g=yt(),w=$("button"),w.textContent=">|",x=yt(),N=$("div"),R=$("button"),H=dt("1 day"),_=yt(),b=$("button"),k=dt("3 days"),Z=yt(),X=$("button"),L=dt("7 days"),V=yt(),A=$("button"),D=dt("14 days"),ot=yt(),ct=$("button"),ft=dt("30 days"),_t=yt(),pt=$("button"),kt=dt("90 days"),qt=yt(),St=$("canvas"),q(r,"text-align","left"),q(r,"color","#000"),q(r,"font-size","12px"),q(r,"font-weight","600"),q(r,"min-width","160px"),q(r,"flex","1 1 auto"),W(l,"class","navbtn svelte-4spgle"),W(l,"title","Jump back by current span"),W(f,"class","navbtn svelte-4spgle"),W(f,"title","Step back 1 day"),W(h,"class","navbtn svelte-4spgle"),W(h,"title","Step forward 1 day"),W(w,"class","navbtn svelte-4spgle"),W(w,"title","Jump forward by current span"),q(u,"display","flex"),q(u,"gap","8px"),q(u,"align-items","center"),q(u,"justify-content","flex-end"),q(u,"flex","0 0 auto"),W(R,"type","button"),W(R,"class",p=At(`qbtn ${t[2]===1?"active":""}`)+" svelte-4spgle"),W(b,"type","button"),W(b,"class",E=At(`qbtn ${t[2]===3?"active":""}`)+" svelte-4spgle"),W(X,"type","button"),W(X,"class",m=At(`qbtn ${t[2]===7?"active":""}`)+" svelte-4spgle"),W(A,"type","button"),W(A,"class",G=At(`qbtn ${t[2]===14?"active":""}`)+" svelte-4spgle"),W(ct,"type","button"),W(ct,"class",et=At(`qbtn ${t[2]===30?"active":""}`)+" svelte-4spgle"),W(pt,"type","button"),W(pt,"class",ht=At(`qbtn ${t[2]===90?"active":""}`)+" svelte-4spgle"),q(N,"display","flex"),q(N,"gap","16px"),q(N,"flex-wrap","wrap"),q(N,"justify-content","flex-end"),q(s,"display","flex"),q(s,"align-items","center"),q(s,"gap","20px"),q(s,"justify-content","flex-end"),q(s,"margin-left","auto"),W(n,"id","controlBar"),q(n,"display","flex"),q(n,"align-items","center"),q(n,"gap","12px"),q(n,"flex-wrap","wrap"),q(n,"margin","0 0 6px"),q(St,"width","100%"),q(St,"display","block"),q(St,"border","0"),W(e,"class","cgm-widget"),q(e,"contain","layout")},m(d,M){_e(d,e,M),T(e,n),T(n,r),T(r,i),t[15](r),T(n,o),T(n,s),T(s,u),T(u,l),T(u,a),T(u,f),T(u,c),T(u,h),T(u,g),T(u,w),T(s,x),T(s,N),T(N,R),T(R,H),T(N,_),T(N,b),T(b,k),T(N,Z),T(N,X),T(X,L),T(N,V),T(N,A),T(A,D),T(N,ot),T(N,ct),T(ct,ft),T(N,_t),T(N,pt),T(pt,kt),T(e,qt),T(e,St),t[26](St),rt||(xt=[Pt(l,"click",t[16]),Pt(f,"click",t[17]),Pt(h,"click",t[18]),Pt(w,"click",t[19]),Pt(R,"click",t[20]),Pt(b,"click",t[21]),Pt(X,"click",t[22]),Pt(A,"click",t[23]),Pt(ct,"click",t[24]),Pt(pt,"click",t[25])],rt=!0)},p(d,M){M[0]&8&&Ht(i,d[3]),M[0]&4&&p!==(p=At(`qbtn ${d[2]===1?"active":""}`)+" svelte-4spgle")&&W(R,"class",p),M[0]&4&&E!==(E=At(`qbtn ${d[2]===3?"active":""}`)+" svelte-4spgle")&&W(b,"class",E),M[0]&4&&m!==(m=At(`qbtn ${d[2]===7?"active":""}`)+" svelte-4spgle")&&W(X,"class",m),M[0]&4&&G!==(G=At(`qbtn ${d[2]===14?"active":""}`)+" svelte-4spgle")&&W(A,"class",G),M[0]&4&&et!==(et=At(`qbtn ${d[2]===30?"active":""}`)+" svelte-4spgle")&&W(ct,"class",et),M[0]&4&&ht!==(ht=At(`qbtn ${d[2]===90?"active":""}`)+" svelte-4spgle")&&W(pt,"class",ht)},i:lt,o:lt,d(d){d&&ie(e),t[15](null),t[26](null),rt=!1,we(xt)}}}const Lt=54;function Tc(t,e,n){let{data:r}=e,{initialRange:i=null}=e,{externalRange:o=null}=e,{preset:s="N"}=e,{showMonthLabels:u=!0}=e;const l=Xi();let a,f;const c={l:48,r:12,t:8,b:8},h=[1,3,7,14,30,90];let g,w,x=24*60*60*1e3;const N=()=>new Date(r.t0).getTime(),R=()=>/mmol/i.test((r==null?void 0:r.units)||"mmol");function H(){return R()?s==="T"?{vlow:3,low:3.9,high:7.8,vhigh:13.9}:s==="P"?{vlow:3,low:3.5,high:7.8,vhigh:13.9}:{vlow:3,low:3.9,high:10,vhigh:13.9}:s==="T"?{vlow:54,low:70,high:140,vhigh:250}:s==="P"?{vlow:54,low:63,high:140,vhigh:250}:{vlow:54,low:70,high:180,vhigh:250}}let p=0,_=0,b=0,k=0;function E(v){let S=h[0],F=1/0;for(const U of h){const P=Math.abs(U-v);P<F&&(F=P,S=U)}return S}function Z(){return Math.max(1,Math.floor((k-b)/x)+1)}let X=14;const L=v=>{const S=new Date(v);return Date.UTC(S.getUTCFullYear(),S.getUTCMonth(),S.getUTCDate())};let m;function V(){m=new Map;for(let v=0;v<w.length;v++){const S=w[v];if(!(Number.isFinite(S)&&S>=0))continue;const F=L(g[v]);let U=m.get(F);U||(U={valid:0,vl:0,l:0,t:0,h:0,vh:0},m.set(F,U)),U.valid++;const P=H();S<P.vlow?U.vl++:S<P.low?U.l++:S<=P.high?U.t++:S<=P.vhigh?U.h++:U.vh++}}function A(){g=Float64Array.from({length:r.glucose.length},(v,S)=>N()+S*r.stepMs),n(12,w=Float64Array.from(r.glucose)),p=L(g[0]),_=L(g[g.length-1]),n(13,b=(i==null?void 0:i.start)??p),n(14,k=(i==null?void 0:i.end)??_),V()}let D;function G(){if(!a||!(m!=null&&m.size))return;const v=Math.max(1,window.devicePixelRatio||1),S=Math.max(320,a.getBoundingClientRect().width||900),F=new Date(p).getUTCFullYear(),U=new Date(_).getUTCFullYear(),P=Mn(F,U+1),at=u?24:c.b,mt=c.t+P.length*Lt+at;n(0,a.style.width=S+"px",a),n(0,a.style.height=mt+"px",a),n(0,a.width=Math.floor(S*v),a),n(0,a.height=Math.floor(mt*v),a),D.setTransform(v,0,0,v,0,0),D.clearRect(0,0,S,mt),D.fillStyle="#fff",D.fillRect(0,0,S,mt);const wt=S-c.l-c.r;D.strokeStyle="#f0f0f0",D.lineWidth=1,P.forEach((gt,st)=>{const I=c.t+st*Lt;for(let J=1;J<12;J++){const O=Date.UTC(gt,J,1);if(O<p||O>_)continue;const nt=(Date.UTC(gt+1,0,1)-Date.UTC(gt,0,1))/x,tt=c.l+Math.round((O-Date.UTC(gt,0,1))/x*(wt/nt));D.beginPath(),D.moveTo(tt,I+6),D.lineTo(tt,I+Lt-6),D.stroke()}}),P.forEach((gt,st)=>{const I=c.t+st*Lt;D.fillStyle="#444",D.font="12px system-ui, sans-serif",D.textAlign="right",D.textBaseline="middle",D.fillText(String(gt),c.l-8,I+Lt/2);const J=Date.UTC(gt,0,1),O=Date.UTC(gt+1,0,1)-x,nt=Math.round((Date.UTC(gt+1,0,1)-Date.UTC(gt,0,1))/x),tt=C=>c.l+Math.floor((C-Date.UTC(gt,0,1))/x*(wt/nt)),Q=Lt-10,ut=I+5;for(let C=Math.max(J,p);C<=Math.min(O,_);C+=x){const it=tt(C),vt=tt(C+x),Vt=Math.max(1,vt-it),Tt=m.get(C);if(!Tt||!Tt.valid){D.fillStyle="#efefef",D.globalAlpha=1,D.fillRect(it,ut,Vt,Q);continue}const ye=Math.max(1,Math.round(x/r.stepMs)),Oe={vl:Tt.vl/Tt.valid,l:Tt.l/Tt.valid,t:Tt.t/Tt.valid,h:Tt.h/Tt.valid,vh:Tt.vh/Tt.valid};let qi=ut+Q;const Xe=(Ic,zc,Wc)=>{const rr=Math.round(zc*Q);rr<=0||(qi-=rr,D.fillStyle=Ic,D.globalAlpha=Wc,D.fillRect(it,qi,Vt,rr))},wn=Tt.valid/ye>=.5?.8:.4,Hc=Tt.valid/ye>=.5?.9:.6;Xe("#e57373",Oe.vl,wn),Xe("#ff9e80",Oe.l,wn),Xe("#86c89d",Oe.t,Hc),Xe("#ffcc80",Oe.h,wn),Xe("#ff8a65",Oe.vh,wn),D.globalAlpha=1}});const Ft=Math.max(p,Math.min(_,b)),$t=Math.max(p,Math.min(_,k));if(P.forEach((gt,st)=>{const I=c.t+st*Lt,J=Date.UTC(gt,0,1),O=Date.UTC(gt+1,0,1)-1,nt=Math.max(J,Ft),tt=Math.min(O,$t);if(nt>tt)return;const Q=(Date.UTC(gt+1,0,1)-Date.UTC(gt,0,1))/x,ut=Tt=>c.l+Math.floor((Tt-Date.UTC(gt,0,1))/x*(wt/Q)),C=ut(nt),it=ut(tt+1),vt=I+5,Vt=Lt-10;D.save(),D.fillStyle="rgba(107,127,161,0.28)",D.fillRect(C,vt,Math.max(1,it-C),Vt),D.strokeStyle="#6b7fa1",D.lineWidth=1.5,D.beginPath(),D.moveTo(C+.5,vt+.5),D.lineTo(C+.5,vt+Vt-.5),D.stroke(),D.beginPath(),D.moveTo(it-.5,vt+.5),D.lineTo(it-.5,vt+Vt-.5),D.stroke(),D.restore()}),u){const gt=Ni("%b"),st=P[P.length-1],I=Date.UTC(st,0,1),O=(Date.UTC(st+1,0,1)-I)/x,nt=ut=>c.l+Math.round((ut-I)/x*(wt/O)),Q=c.t+(P.length-1)*Lt+Lt-5+.5;D.save(),D.strokeStyle="#bbb",D.lineWidth=1,D.fillStyle="#555",D.font="11px system-ui, sans-serif",D.textAlign="center",D.textBaseline="top";for(let ut=0;ut<12;ut++){const C=Date.UTC(st,ut,1),it=nt(C);D.beginPath(),D.moveTo(it,Q),D.lineTo(it,Q+4),D.stroke(),D.fillText(gt(new Date(Date.UTC(2e3,ut,1))),it,Q+6)}D.restore()}}function ot(v,S){const F=new Date(v),U=new Date(S),P=We("%b %e"),at=We("%b %e, %Y"),mt=We("%e, %Y"),wt=Date.UTC(F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate()),Ft=Date.UTC(U.getUTCFullYear(),U.getUTCMonth(),U.getUTCDate());return wt===Ft?at(U):F.getFullYear()===U.getFullYear()?F.getMonth()===U.getMonth()?`${P(F)} – ${mt(U)}`:`${P(F)} – ${at(U)}`:`${at(F)} – ${at(U)}`}let ct="";function ft(){const v=Z();n(2,X=E(v));const S=Math.max(0,Math.ceil((b-g[0])/r.stepMs)),F=Math.min(w.length-1,Math.floor((k-g[0])/r.stepMs));try{typeof window<"u"&&window.CGM_DEBUG&&console.log("[CgmTir] rangechange",{startISO:new Date(b).toISOString(),endISO:new Date(k).toISOString(),days:v,startIdx:S,endIdx:F})}catch{}l("rangechange",{start:b,end:k,days:v,startIdx:S,endIdx:F})}function et(v){n(14,k=_),n(13,b=Math.max(p,k-v*x+1)),ft(),G()}function _t(v){const S=b+v*x,F=k+v*x,U=Math.max(x,F-S);n(13,b=Math.max(p,Math.min(_-U,S))),n(14,k=Math.min(_,b+U)),ft(),G()}function pt(v){const S=Z()*x*v;_t(S/x)}function kt(){const v=a;let S=!1,F=null,U=null,P=0,at=0;const mt=6,wt=st=>{const I=new Date(st);return Date.UTC(I.getUTCFullYear(),I.getUTCMonth(),I.getUTCDate())};function Ft(){const st=Math.max(320,v.getBoundingClientRect().width||900),I=st-c.l-c.r,J=Mn(new Date(p).getUTCFullYear(),new Date(_).getUTCFullYear()+1);return{cssW:st,plotW:I,years:J}}function $t(st,I){const J=(Date.UTC(st+1,0,1)-Date.UTC(st,0,1))/x;return O=>c.l+Math.floor((O-Date.UTC(st,0,1))/x*(I/J))}function gt(st){const I=v.getBoundingClientRect(),J=st.clientX-I.left,O=st.clientY-I.top,{cssW:nt,years:tt}=Ft(),Q=Math.floor((O-8)/Lt);if(Q<0||Q>=tt.length)return null;const ut=tt[Q],C=c.l,it=nt-c.r,vt=Math.max(C,Math.min(it,J)),Vt=(Date.UTC(ut+1,0,1)-Date.UTC(ut,0,1))/x,Tt=(vt-C)/(it-C);let ye=Date.UTC(ut,0,1)+Tt*Vt*x;return ye=Math.max(p,Math.min(_,ye)),{t:ye,yr:ut,x:vt,rowIdx:Q}}v.addEventListener("mousedown",st=>{const I=gt(st);if(!I)return;const{plotW:J}=Ft(),O=$t(I.yr,J),nt=O(Math.max(Date.UTC(I.yr,0,1),b)),tt=O(Math.min(Date.UTC(I.yr+1,0,1)-1,k))+1;F="new",I.x>=nt-mt&&I.x<=nt+mt?F="resize-l":I.x>=tt-mt&&I.x<=tt+mt?F="resize-r":I.x>nt&&I.x<tt&&(F="move"),S=!0,U=I.t,P=b,at=k,document.body.style.userSelect="none",v.style.cursor=F==="move"?"grabbing":F==="new"?"crosshair":"col-resize"}),window.addEventListener("mousemove",st=>{const I=gt(st);if(!I){S||(v.style.cursor="crosshair");return}if(!S){const{plotW:nt}=Ft(),tt=$t(I.yr,nt),Q=tt(Math.max(Date.UTC(I.yr,0,1),b)),ut=tt(Math.min(Date.UTC(I.yr+1,0,1)-1,k))+1;I.x>=Q-mt&&I.x<=Q+mt||I.x>=ut-mt&&I.x<=ut+mt?v.style.cursor="col-resize":I.x>Q&&I.x<ut?v.style.cursor="grab":v.style.cursor="crosshair";return}const J=I.t,O=x;if(F==="new"){const nt=wt(Math.min(U,J)),tt=wt(Math.max(U,J));let Q=Math.max(1,Math.floor((tt-nt)/O)+1);const ut=E(Q);if(J>=U){let C=nt,it=C+ut*O-1;it>_&&(it=_,C=Math.max(p,it-ut*O+1)),n(13,b=C),n(14,k=it)}else{let C=tt+O-1,it=C-ut*O+1;it<p&&(it=p,C=Math.min(_,it+ut*O-1)),n(13,b=it),n(14,k=C)}}else if(F==="resize-l"){const nt=Math.max(1,Math.floor((at-wt(Math.min(J,at-O+1))+1)/O)),tt=E(nt);let Q=at-tt*O+1;Q=Math.max(p,Math.min(Q,at-O+1)),n(13,b=Q),n(14,k=at)}else if(F==="resize-r"){const nt=Math.max(1,Math.floor((wt(J)+O-1-P+1)/O)),tt=E(nt);let Q=P+tt*O-1;Q=Math.min(_,Math.max(Q,P+O-1)),n(13,b=P),n(14,k=Q)}else if(F==="move"){const nt=Math.round((wt(J)-wt(U))/O),tt=at-P+1;let Q=P+nt*O;Q=Math.max(p,Math.min(_-tt+1,Q)),n(13,b=Q),n(14,k=Q+tt-1)}ft(),G()}),window.addEventListener("mouseup",()=>{S&&(S=!1,F=null,U=null,document.body.style.userSelect="",v.style.cursor="crosshair")})}Me(()=>{D=a.getContext("2d"),A(),G();const v=Math.max(0,Math.ceil((b-g[0])/r.stepMs)),S=Math.min(w.length-1,Math.floor((k-g[0])/r.stepMs));l("ready",{start:b,end:k,startIdx:v,endIdx:S,days:Z()}),ft(),kt();const F=()=>G(),U=P=>{const at=P.target&&P.target.tagName?P.target.tagName.toLowerCase():"";if(!(at==="input"||at==="textarea"||at==="select"||P.defaultPrevented)){if(/^[1-6]$/.test(P.key)){const wt={1:1,2:3,3:7,4:14,5:30,6:90}[P.key];et(wt),P.preventDefault();return}if(P.key==="ArrowLeft"||P.key==="ArrowRight"){P.shiftKey?pt(P.key==="ArrowLeft"?-1:1):_t(P.key==="ArrowLeft"?-1:1),P.preventDefault();return}}};return window.addEventListener("resize",F),window.addEventListener("keydown",U),()=>window.removeEventListener("resize",F)});function ht(v){ae[v?"unshift":"push"](()=>{f=v,n(1,f)})}const qt=()=>pt(-1),St=()=>_t(-1),rt=()=>_t(1),xt=()=>pt(1),d=()=>et(1),M=()=>et(3),z=()=>et(7),B=()=>et(14),y=()=>et(30),K=()=>et(90);function Y(v){ae[v?"unshift":"push"](()=>{a=v,n(0,a)})}return t.$$set=v=>{"data"in v&&n(7,r=v.data),"initialRange"in v&&n(8,i=v.initialRange),"externalRange"in v&&n(9,o=v.externalRange),"preset"in v&&n(10,s=v.preset),"showMonthLabels"in v&&n(11,u=v.showMonthLabels)},t.$$.update=()=>{if(t.$$.dirty[0]&25088&&o&&typeof o.start=="number"&&typeof o.end=="number"){const v=o.start,S=o.end;(v!==b||S!==k)&&(n(13,b=v),n(14,k=S),ft(),G())}t.$$.dirty[0]&24576&&n(3,ct=ot(b,k)),t.$$.dirty[0]&5120&&w&&s&&(V(),G())},n(2,X=E(Z())),[a,f,X,ct,et,_t,pt,r,i,o,s,u,w,b,k,ht,qt,St,rt,xt,d,M,z,B,y,K,Y]}class Cc extends Ce{constructor(e){super(),Te(this,e,Tc,Mc,ve,{data:7,initialRange:8,externalRange:9,preset:10,showMonthLabels:11},null,[-1,-1])}}function kc(t){let e,n,r,i,o,s,u,l,a,f,c,h,g,w,x,N,R,H,p,_,b,k,E,Z,X,L,m,V,A,D;return{c(){e=$("div"),n=$("div"),r=$("div"),r.innerHTML="<b>Time Periods</b>",i=$("div"),o=dt(t[4]),s=dt(" ("),u=dt(t[5]),l=dt(" days)"),a=yt(),f=$("div"),c=$("div"),h=$("b"),h.textContent="Average Glucose",g=$("div"),g.textContent=`Goal: ${t[6]()?`Target ${t[7]().low.toFixed(1)}–${t[7]().high.toFixed(1)} mmol/L`:`Target ${Math.round(t[7]().low)}–${Math.round(t[7]().high)} mg/dL`}`,w=$("div"),x=dt(t[0]),N=yt(),R=$("div"),H=$("div"),H.innerHTML='<b>Glucose Management Indicator (GMI)</b><div class="muted svelte-igkjvb">Goal: &lt;7%</div>',p=$("div"),_=dt(t[1]),b=yt(),k=$("div"),E=$("div"),E.innerHTML='<b>Glucose Variability (CV)</b><div class="muted svelte-igkjvb">Goal: ≤36%</div>',Z=$("div"),X=dt(t[2]),L=yt(),m=$("div"),V=dt("Time CGM Active: "),A=dt(t[3]),D=dt("%"),W(n,"class","metric svelte-igkjvb"),W(g,"class","muted svelte-igkjvb"),W(f,"class","metric svelte-igkjvb"),W(R,"class","metric svelte-igkjvb"),W(k,"class","metric svelte-igkjvb"),W(m,"class","muted svelte-igkjvb"),q(m,"font-size","11px"),q(m,"margin-top","6px"),W(e,"class","summary"),q(e,"border","1px solid #eee"),q(e,"border-radius","8px"),q(e,"padding","10px"),q(e,"background","#fff")},m(G,ot){_e(G,e,ot),T(e,n),T(n,r),T(n,i),T(i,o),T(i,s),T(i,u),T(i,l),T(e,a),T(e,f),T(f,c),T(c,h),T(c,g),T(f,w),T(w,x),T(e,N),T(e,R),T(R,H),T(R,p),T(p,_),T(e,b),T(e,k),T(k,E),T(k,Z),T(Z,X),T(e,L),T(e,m),T(m,V),T(m,A),T(m,D)},p(G,[ot]){ot&16&&Ht(o,G[4]),ot&32&&Ht(u,G[5]),ot&1&&Ht(x,G[0]),ot&2&&Ht(_,G[1]),ot&4&&Ht(X,G[2]),ot&8&&Ht(A,G[3])},i:lt,o:lt,d(G){G&&ie(e)}}}function Dc(t,e,n){let{data:r}=e,{range:i=null}=e,{preset:o="N"}=e,s="—",u="—",l="—",a="—",f="",c=0,h,g,w=24*60*60*1e3;const x=()=>/mmol/i.test((r==null?void 0:r.units)||"mmol"),N=p=>x()?p*18:p;function R(){return x()?o==="T"?{vlow:3,low:3.9,high:7.8,vhigh:13.9}:o==="P"?{vlow:3,low:3.5,high:7.8,vhigh:13.9}:{vlow:3,low:3.9,high:10,vhigh:13.9}:o==="T"?{vlow:54,low:70,high:140,vhigh:250}:o==="P"?{vlow:54,low:63,high:140,vhigh:250}:{vlow:54,low:70,high:180,vhigh:250}}function H(){if(!r)return;const p=new Date(r.t0).getTime();n(11,h=Float64Array.from({length:r.glucose.length},(_,b)=>p+b*r.stepMs)),n(12,g=Float64Array.from(r.glucose))}return Me(()=>{H()}),t.$$set=p=>{"data"in p&&n(8,r=p.data),"range"in p&&n(9,i=p.range),"preset"in p&&n(10,o=p.preset)},t.$$.update=()=>{if(t.$$.dirty&256&&r&&H(),t.$$.dirty&6912&&r&&i&&h&&g){const{start:p,end:_}=i,b=Math.max(0,Math.ceil((p-h[0])/r.stepMs)),k=Math.min(g.length-1,Math.floor((_-h[0])/r.stepMs));try{typeof window<"u"&&window.CGM_DEBUG&&console.log("[CgmSummary] update",{startISO:new Date(p).toISOString(),endISO:new Date(_).toISOString(),stepMs:r.stepMs,i0:b,i1:k,len:g.length})}catch{}if(k<b)n(0,s="—"),n(1,u="—"),n(2,l="—"),n(3,a="—"),n(4,f=""),n(5,c=0);else{const E=[];for(let pt=b;pt<=k;pt++){const kt=g[pt];Number.isFinite(kt)&&kt>=0&&E.push(kt)}const Z=Math.max(1,k-b+1),L=100*E.length/Z;n(3,a=`${L.toFixed(1)}%`);const m=go(E),V=so(E)??0,A=Math.sqrt(V),D=Number.isFinite(m)?3.31+.02392*N(m):NaN,G=Number.isFinite(m)&&m!==0?A/m*100:NaN;n(0,s=Number.isFinite(m)?x()?`${m.toFixed(1)} mmol/L`:`${Math.round(m)} mg/dL`:"—"),n(1,u=Number.isFinite(D)?`${D.toFixed(1)}%`:"—"),n(2,l=Number.isFinite(G)?`${G.toFixed(1)}%`:"—");const ot=We("%b %e, %Y"),ct=new Date(p),ft=new Date(_);n(4,f=`${ot(ct)} – ${ot(ft)}`);const et=Date.UTC(ct.getUTCFullYear(),ct.getUTCMonth(),ct.getUTCDate()),_t=Date.UTC(ft.getUTCFullYear(),ft.getUTCMonth(),ft.getUTCDate());n(5,c=Math.max(1,Math.floor((_t-et)/w)+1))}}},[s,u,l,a,f,c,x,R,r,i,o,h,g]}class Nc extends Ce{constructor(e){super(),Te(this,e,Dc,kc,ve,{data:8,range:9,preset:10})}}function Sc(t){let e,n,r,i,o,s,u,l,a,f,c,h,g,w,x,N=t[0].targ.toFixed(1)+"",R,H,p,_,b,k,E,Z,X;return{c(){e=$("div"),n=$("div"),r=$("div"),i=yt(),o=$("div"),s=yt(),u=$("div"),l=yt(),a=$("div"),f=yt(),c=$("div"),h=yt(),g=$("div"),w=$("div"),x=$("span"),R=dt(N),H=dt("%"),p=dt(" in range "),_=$("span"),_.textContent="· Goal >= 70%",b=yt(),k=$("div"),E=dt(t[2]),Z=dt(" Range Used: "),X=dt(t[1]),W(r,"class","seg vlow svelte-mfsfnf"),q(r,"width",t[0].vlow+"%"),W(r,"title","Very low"),W(o,"class","seg low svelte-mfsfnf"),q(o,"width",t[0].low+"%"),W(o,"title","Low"),W(u,"class","seg targ svelte-mfsfnf"),q(u,"width",t[0].targ+"%"),W(u,"title","Target"),W(a,"class","seg high svelte-mfsfnf"),q(a,"width",t[0].high+"%"),W(a,"title","High"),W(c,"class","seg vhigh svelte-mfsfnf"),q(c,"width",t[0].vhigh+"%"),W(c,"title","Very high"),W(n,"class","bar svelte-mfsfnf"),W(x,"class","strong svelte-mfsfnf"),W(_,"class","muted svelte-mfsfnf"),W(w,"class","left svelte-mfsfnf"),W(k,"class","right svelte-mfsfnf"),W(g,"class","legend svelte-mfsfnf"),W(e,"class","tirbar svelte-mfsfnf")},m(L,m){_e(L,e,m),T(e,n),T(n,r),T(n,i),T(n,o),T(n,s),T(n,u),T(n,l),T(n,a),T(n,f),T(n,c),T(e,h),T(e,g),T(g,w),T(w,x),T(x,R),T(x,H),T(w,p),T(w,_),T(g,b),T(g,k),T(k,E),T(k,Z),T(k,X)},p(L,[m]){m&1&&q(r,"width",L[0].vlow+"%"),m&1&&q(o,"width",L[0].low+"%"),m&1&&q(u,"width",L[0].targ+"%"),m&1&&q(a,"width",L[0].high+"%"),m&1&&q(c,"width",L[0].vhigh+"%"),m&1&&N!==(N=L[0].targ.toFixed(1)+"")&&Ht(R,N),m&4&&Ht(E,L[2]),m&2&&Ht(X,L[1])},i:lt,o:lt,d(L){L&&ie(e)}}}function Ac(t,e,n){let r,i,{data:o}=e,{range:s=null}=e,{preset:u="N"}=e,l,a;const f=()=>/mmol/i.test((o==null?void 0:o.units)||"mmol"),c=()=>f()?u==="T"?{vlow:3,low:3.9,high:7.8,vhigh:13.9}:u==="P"?{vlow:3,low:3.5,high:7.8,vhigh:13.9}:{vlow:3,low:3.9,high:10,vhigh:13.9}:u==="T"?{vlow:54,low:70,high:140,vhigh:250}:u==="P"?{vlow:54,low:63,high:140,vhigh:250}:{vlow:54,low:70,high:180,vhigh:250};let h={vlow:0,low:0,targ:0,high:0,vhigh:0};function g(){if(!o)return;const w=new Date(o.t0).getTime();n(6,l=Float64Array.from({length:o.glucose.length},(x,N)=>w+N*o.stepMs)),n(7,a=Float64Array.from(o.glucose))}return Me(()=>{g()}),t.$$set=w=>{"data"in w&&n(3,o=w.data),"range"in w&&n(4,s=w.range),"preset"in w&&n(5,u=w.preset)},t.$$.update=()=>{if(t.$$.dirty&32&&n(2,r=u==="T"?"Tight":u==="P"?"Pregnancy":"General"),t.$$.dirty&40&&n(1,i=(()=>{const w=/mmol/i.test((o==null?void 0:o.units)||"mmol");let x,N;if(w){u==="T"?(x=3.9,N=7.8):u==="P"?(x=3.5,N=7.8):(x=3.9,N=10);const R=H=>{const p=(Math.round(H*10)/10).toFixed(1);return p.endsWith(".0")?p.slice(0,-2):p};return`${R(x)}–${R(N)} mmol/L`}else return u==="T"?(x=70,N=140):u==="P"?(x=63,N=140):(x=70,N=180),`${Math.round(x)}–${Math.round(N)} mg/dL`})()),t.$$.dirty&8&&o&&g(),t.$$.dirty&248&&o&&s&&l&&a&&u){const{start:w,end:x}=s,N=Math.max(0,Math.ceil((w-l[0])/o.stepMs)),R=Math.min(a.length-1,Math.floor((x-l[0])/o.stepMs));if(R<N)n(0,h={vlow:0,low:0,targ:0,high:0,vhigh:0});else{const H=c();let p={vlow:0,low:0,targ:0,high:0,vhigh:0},_=0;for(let b=N;b<=R;b++){const k=a[b];Number.isFinite(k)&&k>=0&&(_++,k<H.vlow?p.vlow++:k<H.low?p.low++:k<=H.high?p.targ++:k<=H.vhigh?p.high++:p.vhigh++)}_===0?n(0,h={vlow:0,low:0,targ:0,high:0,vhigh:0}):n(0,h={vlow:p.vlow/_*100,low:p.low/_*100,targ:p.targ/_*100,high:p.high/_*100,vhigh:p.vhigh/_*100})}}},[h,i,r,o,s,u,l,a]}class Fc extends Ce{constructor(e){super(),Te(this,e,Ac,Sc,ve,{data:3,range:4,preset:5})}}function Uc(t){let e;return{c(){e=sr("svg"),q(e,"width","100%"),q(e,"height","260px"),q(e,"display","block")},m(n,r){_e(n,e,r),t[6](e)},p:lt,i:lt,o:lt,d(n){n&&ie(e),t[6](null)}}}function Be(t,e){if(!t.length)return NaN;const n=(t.length-1)*e,r=Math.floor(n),i=n-r;return t[r]+(t[Math.min(t.length-1,r+1)]-t[r])*(i||0)}function Ec(t,e,n){let{data:r}=e,{range:i=null}=e,{preset:o="N"}=e,s,u=900,l=260;const a={l:50,r:60,t:20,b:26},f=24*60*60*1e3,c=()=>/mmol/i.test((r==null?void 0:r.units)||"mmol"),h=()=>c()?o==="T"?{vlow:3,low:3.9,high:7.8,vhigh:13.9}:o==="P"?{vlow:3,low:3.5,high:7.8,vhigh:13.9}:{vlow:3,low:3.9,high:10,vhigh:13.9}:o==="T"?{vlow:54,low:70,high:140,vhigh:250}:o==="P"?{vlow:54,low:63,high:140,vhigh:250}:{vlow:54,low:70,high:180,vhigh:250};let g,w;function x(){const p=new Date(r.t0).getTime();n(4,g=Float64Array.from({length:r.glucose.length},(_,b)=>p+b*r.stepMs)),n(5,w=Float64Array.from(r.glucose))}function N(p,_){const b=Math.max(1,Math.round(f/r.stepMs)),k=Array.from({length:b},()=>[]),E=new Set;for(let X=p;X<=_;X++){const L=w[X];if(!(Number.isFinite(L)&&L>=0))continue;const m=g[X],V=new Date(m),A=new Date(V.getFullYear(),V.getMonth(),V.getDate()).getTime();E.add(A);let D=Math.round((m-A)/r.stepMs);D<0?D=0:D>=b&&(D=b-1),k[D].push(L)}return{series:k.map((X,L)=>{const m=Float64Array.from(X).sort();return{t:L,p05:Be(m,.05),p25:Be(m,.25),p50:Be(m,.5),p75:Be(m,.75),p95:Be(m,.95)}}),samplesPerDay:b}}function R(){if(!s||!r||!i||!g||!w)return;const p=s.getBoundingClientRect();u=Math.max(360,p.width||900),l=Math.max(220,p.height||260);const _=Xt(s);_.selectAll("*").remove();const b=Math.max(0,Math.ceil((i.start-g[0])/r.stepMs)),k=Math.min(w.length-1,Math.floor((i.end-g[0])/r.stepMs));if(k<b)return;const{series:E,samplesPerDay:Z}=N(b,k);if(!E.flatMap(d=>[d.p05,d.p95]).filter(Number.isFinite).length){_.append("text").attr("x",a.l).attr("y",l/2).text("Not enough data in selection to compute AGP");return}const L=Ye().domain([0,Z-1]).range([a.l,u-a.r]),m=h(),V=c()?20:360,A=Ye().domain([m.vlow,V]).range([l-a.b,a.t]),D=Yt().defined(d=>Number.isFinite(d.p05)&&Number.isFinite(d.p95)&&d.p05<m.low).x(d=>L(d.t)).y0(d=>A(Math.min(d.p95,m.low))).y1(d=>A(d.p05)),G=Yt().defined(d=>Number.isFinite(d.p05)&&Number.isFinite(d.p95)&&d.p95>m.low&&d.p05<m.high).x(d=>L(d.t)).y0(d=>A(Math.min(d.p95,m.high))).y1(d=>A(Math.max(d.p05,m.low))),ot=Yt().defined(d=>Number.isFinite(d.p05)&&Number.isFinite(d.p95)&&d.p95>m.high&&d.p05<m.vhigh).x(d=>L(d.t)).y0(d=>A(Math.min(d.p95,m.vhigh))).y1(d=>A(Math.max(d.p05,m.high))),ct=Yt().defined(d=>Number.isFinite(d.p05)&&Number.isFinite(d.p95)&&d.p95>m.vhigh&&d.p05<m.vhigh).x(d=>L(d.t)).y0(d=>A(d.p95)).y1(d=>A(m.vhigh)),ft=Yt().defined(d=>Number.isFinite(d.p05)&&Number.isFinite(d.p95)&&d.p05>m.vhigh).x(d=>L(d.t)).y0(d=>A(d.p95)).y1(d=>A(d.p05));_.append("rect").attr("x",a.l).attr("width",u-a.r-a.l).attr("y",A(m.high)).attr("height",A(m.low)-A(m.high)).attr("fill","#1a9850").attr("opacity",.1),_.append("path").attr("d",D(E)).attr("fill","#d73027").attr("opacity",.18),_.append("path").attr("d",G(E)).attr("fill","#1a9850").attr("opacity",.12),_.append("path").attr("d",ot(E)).attr("fill","#fdae61").attr("opacity",.18),_.append("path").attr("d",ct(E)).attr("fill","#f46d43").attr("opacity",.26),_.append("path").attr("d",ft(E)).attr("fill","#f46d43").attr("opacity",.26);const et=Yt().defined(d=>Number.isFinite(d.p25)&&Number.isFinite(d.p75)&&d.p75>m.low&&d.p25<m.high).x(d=>L(d.t)).y0(d=>A(Math.min(Math.max(d.p25,m.low),m.high))).y1(d=>A(Math.max(Math.min(d.p75,m.high),m.low))),_t=Yt().defined(d=>Number.isFinite(d.p25)&&Number.isFinite(d.p75)&&d.p75>m.high&&d.p25<m.vhigh).x(d=>L(d.t)).y0(d=>A(Math.min(d.p75,m.vhigh))).y1(d=>A(Math.max(d.p25,m.high))),pt=Yt().defined(d=>Number.isFinite(d.p25)&&Number.isFinite(d.p75)&&d.p75>m.vhigh&&d.p25<m.vhigh).x(d=>L(d.t)).y0(d=>A(d.p75)).y1(d=>A(m.vhigh)),kt=Yt().defined(d=>Number.isFinite(d.p25)&&Number.isFinite(d.p75)&&d.p25<m.low).x(d=>L(d.t)).y0(d=>A(d.p25)).y1(d=>A(Math.min(d.p75,m.low)));_.append("path").attr("d",kt(E)).attr("fill","#d73027").attr("opacity",.35),_.append("path").attr("d",et(E)).attr("fill","#1a9850").attr("opacity",.25),_.append("path").attr("d",_t(E)).attr("fill","#fdae61").attr("opacity",.35),_.append("path").attr("d",pt(E)).attr("fill","#f46d43").attr("opacity",.45);try{let B=function(v,S,F){return v<F&&S>=F||v>F&&S<=F},y=function(v,S,F,U,P){return{t:v+(P-S)*(F-v)/(U-S),p50:P}};const d=v=>v<m.low?"#d73027":v>m.vhigh?"#f46d43":v>m.high?"#fdae61":"#1a9850",M=qe().x(v=>L(v.t)).y(v=>A(v.p50)),z=(v,S,F,U)=>{!Number.isFinite(F.p50)||!Number.isFinite(U.p50)||((!v.length||v[v.length-1].color!==S)&&v.push({color:S,arr:[F]}),v[v.length-1].arr.push(U))};let K=[],Y=null;for(let v=0;v<E.length;v++){const S=E[v];if(!Number.isFinite(S.p50)){Y=null;continue}if(!Y){Y=S;continue}const F=Y.t,U=Y.p50,P=S.t,at=S.p50;let mt=[{t:F,p50:U}],wt=U,Ft=F;const $t=[m.low,m.high,m.vhigh];(at>U?$t:$t.slice().reverse()).forEach(I=>{if(B(wt,at,I)){const J=y(Ft,wt,P,at,I);mt.push(J),wt=J.p50,Ft=J.t}}),mt.push({t:P,p50:at});for(let I=1;I<mt.length;I++){const J=mt[I-1],O=mt[I],nt=(J.p50+O.p50)/2+(O.p50===J.p50?O.t>J.t?1e-6:-1e-6:0),tt=d(nt);z(K,tt,J,O)}Y=S}K.forEach(v=>{v.arr.length>=2&&_.append("path").attr("d",M(v.arr)).attr("stroke",v.color).attr("fill","none").attr("stroke-width",2)})}catch{}_.append("line").attr("x1",a.l).attr("x2",u-a.r).attr("y1",A(m.high)).attr("y2",A(m.high)).attr("stroke","#6ea77b").attr("stroke-width",1),_.append("line").attr("x1",a.l).attr("x2",u-a.r).attr("y1",A(m.low)).attr("y2",A(m.low)).attr("stroke","#6ea77b").attr("stroke-width",1),_.append("line").attr("x1",a.l).attr("x2",u-a.r).attr("y1",A(m.vlow)).attr("y2",A(m.vlow)).attr("stroke","#cccccc").attr("stroke-width",1),_.append("line").attr("x1",a.l).attr("x2",u-a.r).attr("y1",A(m.vhigh)).attr("y2",A(m.vhigh)).attr("stroke","#cccccc").attr("stroke-width",1);const ht=60*60*1e3/r.stepMs,qt=Mn(0,24,3).map(d=>Math.round(d*ht)),St=d=>d===0||d===24?"12am":d<12?`${d}am`:d===12?"12pm":`${d-12}pm`;_.append("g").attr("transform",`translate(0,${l-a.b})`).call(xo(L).tickValues(qt).tickFormat(d=>St(Math.round(d/ht))).tickSizeOuter(0));const rt=[h().vlow,h().low,h().high,h().vhigh,c()?20:360].filter(d=>d>=m.vlow&&d<=V),xt=c()?d=>Math.round(d*10)/10:d=>Math.round(d);_.append("g").attr("transform",`translate(${a.l},0)`).call(bo(A).tickValues(rt).tickFormat(xt)).call(d=>d.select(".domain").remove());try{const d=B=>{for(let y=E.length-1;y>=0;y--){const K=E[y][B];if(Number.isFinite(K))return{t:E[y].t,v:K}}return null},z=(B,y)=>{if(!y)return;const K=Math.min(u-a.r-2,L(y.t)+41),Y=A(y.v);Xt(s).append("text").attr("x",K+5).attr("y",Y).attr("dy","0.35em").attr("text-anchor","start").attr("fill","#000").attr("font-size",11).attr("font-weight",B===50?700:400).text(`${B}%`)};z(5,d("p05")),z(25,d("p25")),z(50,d("p50")),z(75,d("p75")),z(95,d("p95"))}catch{}try{let K=function(Y){const v=A(Y),S=Xt(s).append("text").attr("x",-9999).attr("y",-9999).attr("fill","#fff").attr("font-size",11).attr("font-weight",700).text(y(Y)),F=S.node().getBBox();S.remove();const U=Math.ceil(F.width),P=a.l-8-(U+6*2),at=v-16/2;Xt(s).append("rect").attr("x",P).attr("y",at).attr("rx",5).attr("ry",5).attr("width",U+6*2).attr("height",16).attr("fill",B),Xt(s).append("text").attr("x",P+6).attr("y",v).attr("dy","0.35em").attr("fill","#fff").attr("font-size",11).attr("font-weight",700).text(y(Y))};const B="#1a9850",y=Y=>{if(c()){const v=(Math.round(Y*10)/10).toFixed(1);return v.endsWith(".0")?v.slice(0,-2):v}return Math.round(Y).toString()};K(m.low),K(m.high)}catch{}}Me(()=>{x(),R(),window.addEventListener("resize",R)});function H(p){ae[p?"unshift":"push"](()=>{s=p,n(0,s)})}return t.$$set=p=>{"data"in p&&n(1,r=p.data),"range"in p&&n(2,i=p.range),"preset"in p&&n(3,o=p.preset)},t.$$.update=()=>{t.$$.dirty&62&&r&&i&&g&&w&&o&&R()},[s,r,i,o,g,w,H]}class Rc extends Ce{constructor(e){super(),Te(this,e,Ec,Uc,ve,{data:1,range:2,preset:3})}}function Yc(t){let e;return{c(){e=sr("svg"),q(e,"width","100%"),q(e,"display","block")},m(n,r){_e(n,e,r),t[4](e)},p:lt,i:lt,o:lt,d(n){n&&ie(e),t[4](null)}}}function Lc(t,e,n){let{data:r}=e,{range:i=null}=e,{preset:o="N"}=e,s;const u=()=>/mmol/i.test((r==null?void 0:r.units)||"mmol");function l(){return u()?o==="T"?{vlow:3,low:3.9,high:7.8}:o==="P"?{vlow:3,low:3.5,high:7.8}:{vlow:3,low:3.9,high:10}:o==="T"?{vlow:54,low:70,high:140}:o==="P"?{vlow:54,low:63,high:140}:{vlow:54,low:70,high:180}}let a,f;function c(){if(!r)return;const w=new Date(r.t0).getTime();a=Float64Array.from({length:r.glucose.length},(x,N)=>w+N*r.stepMs),f=Float64Array.from(r.glucose)}function h(){if(!s||!r||!i||!a||!f)return;const w=Xt(s);w.selectAll("*").remove();const x=s.getBoundingClientRect(),N=Math.max(360,x.width||1100),R=7,H=0,p={l:50,r:20,t:30,b:10},_=Math.max(140,Math.floor((N-p.l-p.r-(R-1)*H)/R)),b=86,k=18,E=24*60*60*1e3,Z=i.start,X=i.end,L=Pe.floor(new Date(Z)).getTime(),m=Pe.floor(new Date(X)).getTime(),V=new Date(L),A=new Date(m),D=(V.getDay()+6)%7,G=7-(A.getDay()+6)%7-1,ot=L-D*E,ct=m+G*E,ft=[];for(let rt=ot;rt<=ct;rt+=E)ft.push(rt);const et=ft.length,_t=Math.ceil(et/R),pt=p.t+_t*b+(_t-1)*H+p.b;s.setAttribute("height",pt);const kt=new Map(ft.map(rt=>[rt,[]]));for(let rt=0;rt<f.length;rt++){const xt=f[rt];if(!(Number.isFinite(xt)&&xt>=0))continue;const d=a[rt];if(d<ot||d>ct+E)continue;const M=new Date(d),z=new Date(M.getFullYear(),M.getMonth(),M.getDate()).getTime();kt.has(z)&&kt.get(z).push({t:d-z,v:xt,a:d})}const ht=l(),qt=60*60*1e3/r.stepMs;["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].forEach((rt,xt)=>{_t>0&&Xt(s).append("text").attr("x",p.l+xt*(_+H)+_/2).attr("y",16).attr("text-anchor","middle").attr("fill","#555").attr("font-size",10).text(rt)});for(let rt=1;rt<=R-1;rt++){const xt=p.l+rt*(_+H);for(let d=0;d<_t;d++){const M=p.t+d*(b+H);Xt(s).append("line").attr("x1",xt).attr("x2",xt).attr("y1",M+4).attr("y2",M+b-4).attr("stroke","#e6e6e6").attr("stroke-width",1)}}ft.forEach((rt,xt)=>{const d=Math.floor(xt/R),M=xt%R,z=p.l+M*(_+H),B=p.t+d*(b+H),y=w.append("g").attr("transform",`translate(${z},${B})`),K=Ye().domain([0,24*qt-1]).range([0,_]),Y=Ye().domain(u()?[0,20]:[0,360]).range([b-k,0]);y.append("rect").attr("x",0).attr("y",Y(ht.high)).attr("width",_).attr("height",Math.max(1,Y(ht.low)-Y(ht.high))).attr("fill","#efefef"),y.append("line").attr("x1",0).attr("x2",_).attr("y1",Y(ht.high)).attr("y2",Y(ht.high)).attr("stroke","#2e7d32").attr("opacity",.7),y.append("line").attr("x1",0).attr("x2",_).attr("y1",Y(ht.low)).attr("y2",Y(ht.low)).attr("stroke","#2e7d32").attr("opacity",.7);const v=(kt.get(rt)||[]).slice().sort((C,it)=>C.t-it.t),S=2*r.stepMs,F=[];let U=[];for(const C of v){if(!Number.isFinite(C.v)){U.length&&(F.push(U),U=[]);continue}U.length&&C.t-U[U.length-1].t>S?(F.push(U),U=[C]):U.push(C)}U.length&&F.push(U);const P=C=>C.a>=Z&&C.a<=X,at=Yt().defined(C=>Number.isFinite(C.v)&&C.v>ht.high&&P(C)).x(C=>K(C.t/r.stepMs)).y0(C=>Y(ht.high)).y1(C=>Y(C.v));F.forEach(C=>{C.length>1&&y.append("path").attr("d",at(C)).attr("fill","#fdae61").attr("opacity",.35)});const mt=Yt().defined(C=>Number.isFinite(C.v)&&C.v<ht.low&&P(C)).x(C=>K(C.t/r.stepMs)).y0(C=>Y(C.v)).y1(C=>Y(ht.low));F.forEach(C=>{C.length>1&&y.append("path").attr("d",mt(C)).attr("fill","#d73027").attr("opacity",.25)}),qe().x(C=>K(C.t/r.stepMs)).y(C=>Y(C.v)).curve(er);const wt=C=>Number.isFinite(C.v)&&P(C)&&C.v>=ht.low&&C.v<=ht.high,Ft=C=>Number.isFinite(C.v)&&P(C)&&C.v<ht.low,$t=C=>Number.isFinite(C.v)&&P(C)&&C.v>ht.high,gt=(C,it)=>qe().defined(C).x(vt=>K(vt.t/r.stepMs)).y(vt=>Y(vt.v)).curve(er),st=gt(wt),I=gt(Ft),J=gt($t);F.forEach(C=>{if(C.length>1){const it=qe().defined(vt=>Number.isFinite(vt.v)&&!P(vt)).x(vt=>K(vt.t/r.stepMs)).y(vt=>Y(vt.v)).curve(er);y.append("path").attr("d",it(C)).attr("stroke","#c7c7c7").attr("fill","none").attr("stroke-width",1.2).attr("opacity",.8),y.append("path").attr("d",I(C)).attr("stroke","#d73027").attr("fill","none").attr("stroke-width",1.5),y.append("path").attr("d",J(C)).attr("stroke","#fdae61").attr("fill","none").attr("stroke-width",1.5),y.append("path").attr("d",st(C)).attr("stroke","#1a9850").attr("fill","none").attr("stroke-width",1.5)}});const O=new Date(rt),nt=O.getDate(),ut=nt===1?`1 ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][O.getMonth()]}`:String(nt);y.append("text").attr("x",-12).attr("y",-8).attr("fill","#777").attr("font-size",10).attr("text-anchor","start").text(ut),d<_t-1&&y.append("text").attr("x",_/2).attr("y",b-2).attr("text-anchor","middle").attr("fill","#777").attr("font-size",10).text("12pm")})}Me(()=>{c(),h(),window.addEventListener("resize",h)});function g(w){ae[w?"unshift":"push"](()=>{s=w,n(0,s)})}return t.$$set=w=>{"data"in w&&n(1,r=w.data),"range"in w&&n(2,i=w.range),"preset"in w&&n(3,o=w.preset)},t.$$.update=()=>{t.$$.dirty&14&&r&&i&&o&&h()},[s,r,i,o,g]}class Pc extends Ce{constructor(e){super(),Te(this,e,Lc,Yc,ve,{data:1,range:2,preset:3})}}function nr(t,e,n={}){const r=document.getElementById(t);if(!r)throw new Error(`No element with id "${t}"`);const i=new Cc({target:r,props:{data:e,initialRange:n.initialRange??null,externalRange:null,preset:n.preset||"N",showMonthLabels:n.monthLabels??!0}}),o=new Map;let s=n.initialRange??null;function u(c,h){const g=o.get(c)||[];g.push(h),o.set(c,g)}i.$on("rangechange",c=>{var g;const h=c.detail;s={start:h.start,end:h.end},(g=o.get("rangechange"))==null||g.forEach(w=>w(h))}),i.$on("ready",c=>{var g;const h=c.detail;s={start:h.start,end:h.end},(g=o.get("ready"))==null||g.forEach(w=>w(h))});function l(c,h){if(typeof c=="number"&&typeof h=="number")i.$set({externalRange:{start:c,end:h}});else if(c&&typeof c.start=="number"&&typeof c.end=="number")i.$set({externalRange:{start:c.start,end:c.end}});else throw new Error("setRange expects (start:number, end:number) or {start,end}")}function a(){return s}function f(c){i.$set({preset:c})}return{on:u,setRange:l,getRange:a,setPreset:f,destroy:()=>i.$destroy()}}typeof window<"u"&&(window.createTirCalendar=nr,window.createCgmTir=nr);function Hi(t,e,n={}){const r=document.getElementById(t);if(!r)throw new Error(`No element with id "${t}"`);let i=n.initialRange||null;const o=new Nc({target:r,props:{data:e,range:i,preset:n.preset||"N"}});function s(a,f){if(typeof a=="number"&&typeof f=="number")o.$set({range:{start:a,end:f}});else if(a&&typeof a.start=="number"&&typeof a.end=="number")o.$set({range:a});else throw new Error("setRange expects (start:number, end:number) or {start,end}")}function u(a){o.$set({data:a})}if(n.source&&typeof n.source.on=="function"&&(n.source.on("rangechange",({start:a,end:f})=>s({start:a,end:f})),n.source.on("ready",({start:a,end:f})=>s({start:a,end:f})),typeof n.source.getRange=="function")){const a=n.source.getRange();a&&typeof a.start=="number"&&typeof a.end=="number"&&s(a)}function l(a){o.$set({preset:a})}return{setRange:s,setData:u,setPreset:l,destroy:()=>o.$destroy()}}typeof window<"u"&&(window.createCgmSummary=Hi);function Ii(t,e,n={}){const r=document.getElementById(t);if(!r)throw new Error(`No element with id "${t}"`);let i=n.initialRange||null;const o=new Fc({target:r,props:{data:e,range:i,preset:n.preset||"N"}});function s(a,f){if(typeof a=="number"&&typeof f=="number")o.$set({range:{start:a,end:f}});else if(a&&typeof a.start=="number"&&typeof a.end=="number")o.$set({range:a});else throw new Error("setRange expects (start:number, end:number) or {start,end}")}function u(a){o.$set({data:a})}if(n.source&&typeof n.source.on=="function"&&(n.source.on("rangechange",({start:a,end:f})=>s({start:a,end:f})),n.source.on("ready",({start:a,end:f})=>s({start:a,end:f})),typeof n.source.getRange=="function")){const a=n.source.getRange();a&&typeof a.start=="number"&&typeof a.end=="number"&&s(a)}function l(a){o.$set({preset:a})}return{setRange:s,setData:u,setPreset:l,destroy:()=>o.$destroy()}}typeof window<"u"&&(window.createCgmTirBar=Ii);function zi(t,e,n={}){const r=document.getElementById(t);if(!r)throw new Error(`No element with id "${t}"`);let i=n.initialRange||null;const o=new Rc({target:r,props:{data:e,range:i,preset:n.preset||"N"}});function s(a,f){if(typeof a=="number"&&typeof f=="number")o.$set({range:{start:a,end:f}});else if(a&&typeof a.start=="number"&&typeof a.end=="number")o.$set({range:a});else throw new Error("setRange expects (start:number, end:number) or {start,end}")}function u(a){o.$set({data:a})}if(n.source&&typeof n.source.on=="function"&&(n.source.on("rangechange",({start:a,end:f})=>s({start:a,end:f})),n.source.on("ready",({start:a,end:f})=>s({start:a,end:f})),typeof n.source.getRange=="function")){const a=n.source.getRange();a&&typeof a.start=="number"&&typeof a.end=="number"&&s(a)}function l(a){o.$set({preset:a})}return{setRange:s,setData:u,setPreset:l,destroy:()=>o.$destroy()}}typeof window<"u"&&(window.createCgmAgp=zi);function Wi(t,e,n={}){const r=document.getElementById(t);if(!r)throw new Error(`No element with id "${t}"`);let i=n.initialRange||null;const o=new Pc({target:r,props:{data:e,range:i,preset:n.preset||"N"}});function s(a,f){if(typeof a=="number"&&typeof f=="number")o.$set({range:{start:a,end:f}});else if(a&&typeof a.start=="number"&&typeof a.end=="number")o.$set({range:a});else throw new Error("setRange expects (start:number, end:number) or {start,end}")}function u(a){o.$set({data:a})}function l(a){o.$set({preset:a})}if(n.source&&typeof n.source.on=="function"&&(n.source.on("rangechange",({start:a,end:f})=>s({start:a,end:f})),n.source.on("ready",({start:a,end:f})=>s({start:a,end:f})),typeof n.source.getRange=="function")){const a=n.source.getRange();a&&typeof a.start=="number"&&typeof a.end=="number"&&s(a)}return{setRange:s,setData:u,setPreset:l,destroy:()=>o.$destroy()}}typeof window<"u"&&(window.createCgmStrips=Wi),Ct.createCgmAgp=zi,Ct.createCgmStrips=Wi,Ct.createCgmSummary=Hi,Ct.createCgmTirBar=Ii,Ct.createTirCalendar=nr,Object.defineProperty(Ct,Symbol.toStringTag,{value:"Module"})});
